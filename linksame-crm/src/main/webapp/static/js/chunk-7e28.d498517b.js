(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7e28","chunk-4530"],{"+9th":function(e,t,a){"use strict";a.d(t,"k",function(){return n}),a.d(t,"a",function(){return r}),a.d(t,"d",function(){return l}),a.d(t,"e",function(){return s}),a.d(t,"g",function(){return c}),a.d(t,"h",function(){return i}),a.d(t,"b",function(){return m}),a.d(t,"f",function(){return u}),a.d(t,"c",function(){return d}),a.d(t,"j",function(){return p}),a.d(t,"i",function(){return f});var o=a("t3Un");function n(e){return Object(o.a)({url:"task/queryTaskList",method:"post",data:e})}function r(e){return Object(o.a)({url:"task/setTask",method:"post",data:e})}function l(e){return Object(o.a)({url:"task/deleteTask",method:"post",data:e})}function s(e){return Object(o.a)({url:"task/queryTaskInfo",method:"post",data:e})}function c(e){return Object(o.a)({url:"task/setTask",method:"post",data:e})}function i(e){return Object(o.a)({url:"task/saveTaskRelation",method:"post",data:e})}function m(e){return Object(o.a)({url:"taskLabel/setLabel",method:"post",data:e})}function u(e){return Object(o.a)({url:"taskLabel/setLabel",method:"post",data:e})}function d(e){return Object(o.a)({url:"taskLabel/deleteLabel",method:"post",data:e})}function p(e){return Object(o.a)({url:"taskLabel/getLabelList",method:"post",data:e})}function f(e){return Object(o.a)({url:"task/queryWorkTaskLog",method:"post",data:e})}},"+sWE":function(e,t,a){},"1RnH":function(e,t,a){"use strict";a.r(t);var o=a("QbLZ"),n=a.n(o),r=a("+9th"),l=a("mkuN"),s=a("Er7M"),c=a("7Qib"),i=a("L2JU"),m={components:{CrmRelative:l.a,RelatedBusinessCell:s.a},props:{marginLeft:{type:String,default:"20px"},allData:{type:Object,default:function(){return{contacts:[],customer:[],business:[],contract:[]}}},isTask:{type:Boolean,default:!1},taskID:Number,alterable:{type:Boolean,default:!0},alterableColor:{type:String,default:"#999"}},data:function(){return{showTypes:["customer","contacts","business","contract"],showPopover:!1,relevanceAll:{customerIds:[],contractIds:[],contactsIds:[],businessIds:[]},relatedListData:{},showRelative:!1,showTaskRelative:!1}},computed:n()({},Object(i.b)(["crm"]),{showCRMPermission:function(){return this.crm}}),watch:{allData:function(){this.relatedListData=this.allData}},mounted:function(){this.relatedListData=this.allData},methods:{crmrelativeClose:function(){this.showPopover=!1},checkInfos:function(e){var t=this;this.showPopover=!1,this.relatedListData=e.data;var a=function(a){var o=e.data[a];t.relevanceAll[a+"Ids"]=o.map(function(e,t,o){return e[a+"Id"]})};for(var o in e.data)a(o);this.$emit("checkInfos",this.relevanceAll)},delRelevance:function(e,t,a){var o=this;this.$confirm("确认取消关联?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"is-particulars"}).then(function(){var a={taskId:o.taskID},n=Object(c.k)(o.relatedListData);n[e].splice(t,1);for(var l=function(e){var t=o.showTypes[e],r=n[t]||[];a[t+"Ids"]=r.map(function(e){return e[t+"Id"]}).join(",")},s=0;s<o.showTypes.length;s++)l(s);Object(r.h)(a).then(function(a){o.relatedListData[e].splice(t,1),o.relatedListData=Object(c.k)(o.relatedListData),o.$message.success("关联取消成功")}).catch(function(){})}).catch(function(){o.$message.info("已取消操作")})},checkRelatedDetail:function(e,t){t.key=t[e+"Id"],this.$emit("checkRelatedDetail",e,t)}}},u=(a("VPPU"),a("KHd+")),d=Object(u.a)(m,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"related-business",style:{"margin-left":e.marginLeft}},[!e.isTask&&e.alterable?o("el-popover",{attrs:{placement:"bottom",width:"800","popper-class":"no-padding-popover",trigger:"click"},model:{value:e.showPopover,callback:function(t){e.showPopover=t},expression:"showPopover"}},[e.showRelative?o("crm-relative",{ref:"crmrelative",attrs:{show:e.showPopover,radio:!1,"selected-data":e.relatedListData,"show-types":e.showTypes},on:{close:e.crmrelativeClose,changeCheckout:e.checkInfos}}):e._e(),e._v(" "),e.showCRMPermission?o("p",{staticClass:"add-file",attrs:{slot:"reference"},on:{click:function(t){e.showRelative=!0}},slot:"reference"},[o("img",{attrs:{src:a("AFlK"),alt:""}}),e._v("\n      关联业务\n    ")]):e._e()],1):e._e(),e._v(" "),e.alterable?e._e():o("p",{staticClass:"alterable-p",style:{color:e.alterableColor}},[e._v("关联业务")]),e._v(" "),e._l(e.relatedListData,function(t,a){return o("div",{key:a},e._l(t,function(t,n){return o("related-business-cell",{key:n,attrs:{data:t,"cell-index":n,type:a,"show-foot":e.isTask},on:{unbind:e.delRelevance,detail:function(o){e.checkRelatedDetail(a,t)}}})}))}),e._v(" "),e.isTask?o("el-popover",{attrs:{placement:"bottom",width:"800","popper-class":"no-padding-popover",trigger:"click"},model:{value:e.showPopover,callback:function(t){e.showPopover=t},expression:"showPopover"}},[e.showTaskRelative?o("crm-relative",{ref:"crmrelative",attrs:{radio:!1,show:e.showPopover,"selected-data":e.relatedListData,"show-types":e.showTypes},on:{close:e.crmrelativeClose,changeCheckout:e.checkInfos}}):e._e(),e._v(" "),e.showCRMPermission?o("p",{staticClass:"add-file",attrs:{slot:"reference"},on:{click:function(t){e.showTaskRelative=!0}},slot:"reference"},[o("img",{attrs:{src:a("AFlK"),alt:""}}),e._v("\n      关联业务\n    ")]):e._e()],1):e._e()],2)},[],!1,null,"e9d30324",null);d.options.__file="relatedBusiness.vue";t.default=d.exports},"4dUy":function(e,t,a){},Qc8A:function(e,t,a){"use strict";var o=a("+sWE");a.n(o).a},VPPU:function(e,t,a){"use strict";var o=a("4dUy");a.n(o).a},"qf+I":function(e,t,a){"use strict";a.r(t);a("SP+9");var o={name:"DialogPayment",components:{relatedBusiness:a("1RnH").default},props:{status:{type:Boolean,default:void 0}},data:function(){return{allData:{},relevanceAll:{},tableData:[{date:"2016-05-03",address:"设计清单"}],options:[{value:"zhinan",label:"DP设计类",children:[{value:"shejiyuanze",label:"建筑设计"},{value:"daohang",label:"精装修设计"},{value:"daohang",label:"燃气设计"}]}],dialogVisible:!1,dialogVisibleMilestone:!1,moneyMax:0,form:{contractType:"",contractName:"",contractNumber:"",contractPurchaseStartTime:"",contractPurchaseEndTime:"",beginTime:"",endTime:"",supplierId:void 0,agent:void 0,drpNumber:"",money:1e6,pmpContractPayments:[{payment_name:"",cost_percentage:void 0,money:1e6,payment_node:""}]}}},computed:{},watch:{moneyMax:function(){console.log(this.moneyMax)}},mounted:function(){},methods:{computeMoney:function(e){},checkInfos:function(e){this.relevanceAll=e,console.log("checkInfos",e)},createContact:function(){console.log(this.form),this.form.pmpContractPayments.forEach(function(e,t){console.log(111,e.money)}),this.form={contractType:"",contractName:"",contractNumber:"",contractPurchaseStartTime:"",contractPurchaseEndTime:"",beginTime:"",endTime:"",supplierId:void 0,agent:void 0,drpNumber:"",money:1e6,pmpContractPayments:[{payment_name:"",cost_percentage:void 0,money:1e6,payment_node:""}]}},detailpmpContractPayments:function(e,t){console.log(e),"delete"==e?this.form.pmpContractPayments.splice(t,1):this.form.pmpContractPayments.push({payment_name:"",cost_percentage:void 0,money:void 0,payment_node:""})}}},n=(a("Qc8A"),a("KHd+")),r=Object(n.a)(o,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-divider",{attrs:{"content-position":"left"}},[e._v("基本信息")]),e._v(" "),a("el-form",{ref:"form",attrs:{model:e.form,inline:!0,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"所属合同类型"}},[a("el-select",{attrs:{placeholder:"请选合同类型"},model:{value:e.form.contractType,callback:function(t){e.$set(e.form,"contractType",t)},expression:"form.contractType"}},[a("el-option",{attrs:{label:"类型一",value:"shanghai"}}),e._v(" "),a("el-option",{attrs:{label:"类型二",value:"beijing"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"合同名称"}},[a("el-input",{model:{value:e.form.contractName,callback:function(t){e.$set(e.form,"contractName",t)},expression:"form.contractName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"合同编号"}},[a("el-input",{attrs:{placeholder:"请输入合同编号"},model:{value:e.form.contractNumber,callback:function(t){e.$set(e.form,"contractNumber",t)},expression:"form.contractNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"合同采购时间"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期",align:"right"},model:{value:e.form.contractPurchaseStartTime,callback:function(t){e.$set(e.form,"contractPurchaseStartTime",t)},expression:"form.contractPurchaseStartTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"合同开始日期"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期",align:"right"},model:{value:e.form.beginTime,callback:function(t){e.$set(e.form,"beginTime",t)},expression:"form.beginTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"合同结束日期"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期",align:"right"},model:{value:e.form.endTime,callback:function(t){e.$set(e.form,"endTime",t)},expression:"form.endTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"承包商"}},[a("el-select",{attrs:{placeholder:"请选合同承包商"},model:{value:e.form.supplierId,callback:function(t){e.$set(e.form,"supplierId",t)},expression:"form.supplierId"}},[a("el-option",{attrs:{label:"承包商一",value:"11"}}),e._v(" "),a("el-option",{attrs:{label:"承包商二",value:"11"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"经办人"}},[a("el-select",{attrs:{placeholder:"请选合同经办人"},model:{value:e.form.agent,callback:function(t){e.$set(e.form,"agent",t)},expression:"form.agent"}},[a("el-option",{attrs:{label:"经办人一",value:"12"}}),e._v(" "),a("el-option",{attrs:{label:"经办人二",value:"12"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"DRP采购单号"}},[a("el-input",{attrs:{placeholder:"请输入单号"},model:{value:e.form.drpNumber,callback:function(t){e.$set(e.form,"drpNumber",t)},expression:"form.drpNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"合同金额"}},[a("el-input",{attrs:{placeholder:"请输入金额"},model:{value:e.form.money,callback:function(t){e.$set(e.form,"money",t)},expression:"form.money"}})],1)],1),e._v(" "),a("el-divider",{attrs:{"content-position":"left"}},[e._v("支付方式")]),e._v(" "),e._l(e.form.pmpContractPayments,function(t,o){return a("el-form",{key:o,ref:"form",refInFor:!0,attrs:{model:e.form,inline:!0,"label-width":"30px"}},[a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{placeholder:"款项"},model:{value:e.form.pmpContractPayments[o].payment_name,callback:function(t){e.$set(e.form.pmpContractPayments[o],"payment_name",t)},expression:"form.pmpContractPayments[index].payment_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"--"}},[a("el-input",{attrs:{placeholder:"支付比例"},model:{value:e.form.pmpContractPayments[o].cost_percentage,callback:function(t){e.$set(e.form.pmpContractPayments[o],"cost_percentage",t)},expression:"form.pmpContractPayments[index].cost_percentage"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"--"}},[a("el-input",{attrs:{placeholder:"支付金额"},on:{input:function(t){e.computeMoney(e.form.pmpContractPayments[o].money)}},model:{value:e.form.pmpContractPayments[o].money,callback:function(t){e.$set(e.form.pmpContractPayments[o],"money",t)},expression:"form.pmpContractPayments[index].money"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"--"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期",align:"right"},model:{value:e.form.pmpContractPayments[o].payment_node,callback:function(t){e.$set(e.form.pmpContractPayments[o],"payment_node",t)},expression:"form.pmpContractPayments[index].payment_node"}})],1),e._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(t){e.detailpmpContractPayments("delete",o)}}})],1)],1)}),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.detailpmpContractPayments("add")}}},[e._v("增加付款方式")]),e._v(" "),a("el-divider",{attrs:{"content-position":"left"}},[e._v("关联业务")]),e._v(" "),a("related-business",{attrs:{"all-data":e.allData,"margin-left":"0"},on:{checkInfos:e.checkInfos}})],2)},[],!1,null,"411da050",null);r.options.__file="DialogCreate.vue";t.default=r.exports}}]);