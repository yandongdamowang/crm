(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-47f8"],{"6MHy":function(t,e,a){"use strict";var l=a("i2Ro");a.n(l).a},"7Tog":function(t,e,a){"use strict";a.d(e,"b",function(){return r}),a.d(e,"a",function(){return o}),a.d(e,"c",function(){return i});var l=a("t3Un");function r(t){return Object(l.a)({url:"pmpContractPayment/queryAdvanceList",method:"post",data:t})}function o(t){return Object(l.a)({url:"pmpContractPayment/queryAdvanceBybillId",method:"post",data:t})}function i(t){return Object(l.a)({url:"pmpContractPayment/setPriority",method:"post",data:t})}},hTPI:function(t,e,a){"use strict";a.r(e);var l=a("QbLZ"),r=a.n(l),o=a("7Tog"),i={name:"ContractIndex",components:{DrawerDetail:function(){return a.e("chunk-4fb3").then(a.bind(null,"nqXz"))}},data:function(){return{dialogComponents:"",dialogTitle:"",dialogwidth:"",dialogVisible:!1,dialogPaymentCommitStatus:!1,drawerComponents:"",drawer:!1,drawerTitle:"",drawerData:"",dialogData:"",dialogUserData:"",pageCurrent:1,pageTotal:1,pageSize:10,prepaymentBillListData:[],grep:"",search:{contractNumber:"",supplierId:""},formData:{appliedAmountBefore:0,pmpContractPayment:{billId:"",ownerUserId:"",remark:"",applicantCompany:""},checkUserId:void 0},deleteData:void 0}},computed:{appliedAmount:function(){return this.formData.appliedAmountBefore}},mounted:function(){this.retrivePrepaymentBillList()},methods:{drawerStatus:function(t){console.log("drawerStatus",t),this.drawer=t,this.retrivePrepaymentBillList()},handleCurrentChange:function(t){console.log("当前页: "+t),this.pageCurrent=t,this.retrivePrepaymentBillList()},handleSizeChange:function(t){console.log("每页 "+t+" 条"),this.pageSize=t,this.retrivePrepaymentBillList()},retrivePrepaymentBillList:function(){var t=this;Object(o.b)(r()({page:this.pageCurrent,limit:this.pageSize},this.search)).then(function(e){console.log(e),t.prepaymentBillListData=e.data.list,t.pageTotal=e.data.totalRow}).catch(function(){})},searchReset:function(){this.search={contractNumber:"",supplierId:""},this.retrivePrepaymentBillList()},commitData:function(){var t=this;this.$request({url:"/examineRecord/addExamine",method:"post",data:{pmpContractPayment:{billId:this.dialogData.billId,ownerUserId:this.dialogData.ownerUserId,appliedAmount:parseInt(this.appliedAmount),remark:this.formData.pmpContractPayment.remark,applicantCompany:this.formData.pmpContractPayment.applicantCompany},checkUserId:this.formData.checkUserId},headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){console.log(e),t.formData={appliedAmountBefore:0,pmpContractPayment:{billId:"",ownerUserId:"",remark:"",applicantCompany:""},checkUserId:void 0},t.dialogVisible=!1}).catch(function(){t.formData={appliedAmountBefore:0,pmpContractPayment:{billId:"",ownerUserId:"",remark:"",applicantCompany:""},checkUserId:void 0},t.dialogVisible=!1})},dialogPaymentApply:function(t){var e=this;this.dialogVisible=!0,this.dialogTitle="申请付款",this.dialogwidth="50%",console.log(t),this.$request({url:"/system/user/queryUserList",method:"post",data:{roleId:8,pageType:0}}).then(function(t){console.log("审批人",t.data),e.dialogUserData=t.data}).catch(function(){}),this.$request({url:"/pmpContractPayment/queryAdvanceBybillId",method:"post",data:{billId:t.billId},headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){console.log("预付款详情",t),e.dialogData=t.data}).catch(function(t){console.log(t)})},dialogPaymentCommit:function(t){this.dialogPaymentCommitStatus=!0,this.dialogTitle="确认收款",this.dialogwidth="50%"},drawerDetail:function(t){this.drawer=!0,this.drawerComponents="DrawerDetail",this.drawerData=t.billId}}},n=(a("6MHy"),a("KHd+")),s=Object(n.a)(i,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{height:"100%"}},[a("div",{staticClass:"ls-header"},[t._v("\n    预付款账单\n    "),a("div",{staticClass:"ls-header-r"},[a("el-select",{attrs:{placeholder:"选择项目"},model:{value:t.grep,callback:function(e){t.grep=e},expression:"grep"}},[a("el-option",{attrs:{label:"项目一",value:"shanghai"}}),t._v(" "),a("el-option",{attrs:{label:"项目二",value:"beijing"}})],1)],1)]),t._v(" "),a("div",{staticClass:"ls-box"},[a("el-form",{ref:"form",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"合同编号："}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.search.contractNumber,callback:function(e){t.$set(t.search,"contractNumber",e)},expression:"search.contractNumber"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"客户："}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.search.supplierId,callback:function(e){t.$set(t.search,"supplierId",e)},expression:"search.supplierId"}})],1),t._v(" "),a("el-form-item",[a("span",[a("el-button",{attrs:{type:"primary"},on:{click:t.retrivePrepaymentBillList}},[t._v("查询")])],1),t._v(" "),a("span",[a("el-button",{on:{click:t.searchReset}},[t._v("重置")])],1)])],1),t._v(" "),a("el-table",{staticStyle:{margin:"20px 0 0 0"},attrs:{data:t.prepaymentBillListData,"header-cell-style":{background:"#F5F7FA",color:"#606266"},border:"",height:"80%"}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{prop:"contractNumber",label:"合同编号",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.drawerDetail(e.row)}}},[t._v(t._s(e.row.contractNumber))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"paymentName",label:"款项"}}),t._v(" "),a("el-table-column",{attrs:{prop:"customerName",label:"客户/承包商"}}),t._v(" "),a("el-table-column",{attrs:{prop:"money",label:"预付金额"}}),t._v(" "),a("el-table-column",{attrs:{prop:"costPercentage",label:"预付比例",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"paymentNode",label:"计划付款时间",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"priority",label:"优先级",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.priority?a("span",[a("el-tag",{attrs:{type:"danger"}},[t._v("高")])],1):"2"==e.row.priority?a("span",[a("el-tag",{attrs:{type:"warning"}},[t._v("中")])],1):"3"==e.row.priority?a("span",[a("el-tag",{attrs:{type:"success"}},[t._v("低")])],1):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"tradeStatus",label:"状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.tradeStatus?a("span",[a("el-tag",{attrs:{type:"success"}},[t._v("交易完成")])],1):"2"==e.row.tradeStatus?a("span",[a("el-tag",{attrs:{type:"warning"}},[t._v("待交易")])],1):"3"==e.row.tradeStatus?a("span",[a("el-tag",{attrs:{type:"danger"}},[t._v("带审批")])],1):"4"==e.row.tradeStatus?a("span",[a("el-tag",{attrs:{type:"info"}},[t._v("延期")])],1):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.dialogPaymentApply(e.row)}}},[t._v("申请付款")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.dialogPaymentCommit(e.row)}}},[t._v("确认收款")])]}}])})],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogVisible,title:t.dialogTitle,width:t.dialogwidth},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"form",attrs:{"label-width":"120px"}},[a("el-divider",{attrs:{"content-position":"left"}},[t._v("基本信息")]),t._v(" "),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"合同编号："}},[a("div",[t._v(t._s(t.dialogData.contractNumber))])]),t._v(" "),a("el-form-item",{attrs:{label:"计划付款日期："}},[a("div",[t._v(t._s(t.dialogData.paymentNode))])])],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"款项 ："}},[a("div",[t._v(t._s(t.dialogData.paymentName))])]),t._v(" "),a("el-form-item",{attrs:{label:"承包商："}},[a("div",[t._v(t._s(t.dialogData.customerName))])])],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"预付金额："}},[a("div",[t._v(t._s(t.dialogData.money))])]),t._v(" "),a("el-form-item",{attrs:{label:"业主："}},[a("div",[t._v(t._s(t.dialogData.proprietor))])])],1)],1),t._v(" "),a("el-divider",{attrs:{"content-position":"left"}},[t._v("申请金额")]),t._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"合同金额 ："}},[a("div",[t._v(t._s(t.dialogData.contractMoney))])]),t._v(" "),a("el-form-item",{attrs:{label:"本次申请金额："}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.formData.appliedAmountBefore,callback:function(e){t.$set(t.formData,"appliedAmountBefore",e)},expression:"formData.appliedAmountBefore"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"申请付款时间 ："}},[a("div",[t._v("待开发")])]),t._v(" "),a("el-form-item",{attrs:{label:"累计付款金额："}},[t._v(t._s(t.appliedAmount)+" "+t._s(t.dialogData.totalPayment))])],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"申请原因概述："}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:t.formData.pmpContractPayment.remark,callback:function(e){t.$set(t.formData.pmpContractPayment,"remark",e)},expression:"formData.pmpContractPayment.remark"}})],1)],1)],1),t._v(" "),a("el-divider",{attrs:{"content-position":"left"}},[t._v("信息审核")]),t._v(" "),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"申请单位："}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.formData.pmpContractPayment.applicantCompany,callback:function(e){t.$set(t.formData.pmpContractPayment,"applicantCompany",e)},expression:"formData.pmpContractPayment.applicantCompany"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"审批人："}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.formData.checkUserId,callback:function(e){t.$set(t.formData,"checkUserId",e)},expression:"formData.checkUserId"}},t._l(t.dialogUserData,function(t,e){return a("el-option",{key:e,attrs:{label:t.realname,value:t.userId}})}))],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"项目负责人："}},[a("div",[t._v(t._s(t.dialogData.ownerUserName))])])],1)],1)],1),t._v(" "),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.commitData}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogPaymentCommitStatus,title:t.dialogTitle,width:t.dialogwidth},on:{"update:visible":function(e){t.dialogPaymentCommitStatus=e}}},[a("el-form",{ref:"form",attrs:{"label-width":"120px"}},[a("el-divider",{attrs:{"content-position":"left"}},[t._v("基本信息")]),t._v(" "),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"合同编号："}},[a("div",[t._v(t._s(t.dialogData.contractNumber))])]),t._v(" "),a("el-form-item",{attrs:{label:"计划付款日期："}},[a("div",[t._v(t._s(t.dialogData.paymentNode))])])],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"款项 ："}},[a("div",[t._v(t._s(t.dialogData.paymentName))])]),t._v(" "),a("el-form-item",{attrs:{label:"承包商："}},[a("div",[t._v(t._s(t.dialogData.customerName))])])],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"预付金额："}},[a("div",[t._v(t._s(t.dialogData.money))])]),t._v(" "),a("el-form-item",{attrs:{label:"业主："}},[a("div",[t._v(t._s(t.dialogData.proprietor))])])],1)],1)],1),t._v(" "),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogPaymentCommitStatus=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.commitData}},[t._v("确 定")])],1)],1),t._v(" "),a("el-drawer",{attrs:{title:t.drawerTitle,visible:t.drawer,"with-header":!1,"destroy-on-close":!0,size:"70%"},on:{"update:visible":function(e){t.drawer=e},open:function(e){t.drawerDetail()}}},[a("keep-alive",{attrs:{include:[]}},[a(t.drawerComponents,{tag:"component",attrs:{"drawer-data":t.drawerData},on:{drawerStatus:t.drawerStatus}})],1)],1),t._v(" "),a("div",{staticClass:"ls-pagination"},[a("el-pagination",{attrs:{"current-page":t.pageCurrent,"page-sizes":[2,10,20],"page-size":t.pageSize,total:t.pageTotal,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)])},[],!1,null,"4c45cd21",null);s.options.__file="Main.vue";e.default=s.exports},i2Ro:function(t,e,a){}}]);