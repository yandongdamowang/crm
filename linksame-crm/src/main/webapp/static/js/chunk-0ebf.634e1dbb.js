(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0ebf"],{"7suQ":function(e,t,o){},oXuL:function(e,t,o){"use strict";var i=o("7suQ");o.n(i).a},odM5:function(e,t,o){"use strict";o.r(t);var i=o("4peS"),a=o.n(i),l={name:"App",components:{},props:{versionData:{type:Object,default:void 0},projectId:{type:Number,default:void 0},folderId:{type:Number,default:void 0},batchId:{type:String,default:void 0}},data:function(){return{folderListData:[],defaultProps:{children:"list",label:"folderName"},dialogLocalStatus:!1,dialogNetdiskStatus:!1,folderName:"",fileTypeId:void 0,fileTypeList:[],fileRemark:void 0,uploadAction:"",uploadActionVersion:"",uploadHeaders:{"Admin-Token":a.a.get("Admin-Token")}}},watch:{},created:function(){},mounted:function(){console.log("versionData",this.versionData),console.log("batchId",this.batchId),this.retriveFolderList(),this.retriveTypeList()},methods:{handleNodeClick:function(e){console.log("选中的文件夹",e),this.folderId=e.folderId,this.folderName=e.folderName,this.retriveFileList()},retriveTypeList:function(){var e=this;this.$request.post("/type/queryList?pageType=0").then(function(t){console.log("附件类型列表",t),e.fileTypeList=t.data}).catch(function(e){console.log("retriveTypeList err",e)})},localUpload:function(){console.log("workID",this.$route.params.id),void 0===this.versionData?this.uploadAction="/file/upload?folderId="+this.folderId+"&typeId="+this.fileTypeId+"&workId="+this.$route.params.id+"&batchId="+this.batchId:this.uploadAction="/file/changeVersion?fileId="+this.versionData.fileId+"&folderId="+this.versionData.folderId+"&fileRemark="+this.fileRemark+"&workId="+this.$route.params.id+"&batchId="+this.batchId,this.dialogLocalStatus=!0,console.log("上传地址",this.uploadAction)},beforeUpload:function(e){return null==this.folderId?(this.$message.error("请选择上传的文件夹"),!1):void 0==this.fileTypeId?(this.$message.error("请选择文件类型"),!1):void 0},dialogClose:function(){},selectChanged:function(e){void 0!==this.versionData&&void 0===this.fileRemark&&this.$message.error("请填写备注"),this.fileTypeId=e,this.localUpload()},onSuccess:function(){console.log("成功"),this.$emit("uploadStatus",!1),this.dialogLocalStatus=!1,this.$message.success("上传成功"),this.fileRemark=void 0,this.fileTypeId=void 0},retriveFolderList:function(){var e=this;this.$request.post("/folder/queryFolder").then(function(t){console.log(t),e.folderListData=t.data}).catch(function(e){console.log("retriveFolderList err",e)})}}},s=(o("oXuL"),o("KHd+")),d=Object(s.a)(l,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"ls-upload"},[i("span",[i("span",{on:{click:function(t){e.dialogLocalStatus=!0}}},[e._v(e._s(void 0===e.versionData?"上传文件":"替换版本"))])]),e._v(" "),i("el-dialog",{attrs:{visible:e.dialogLocalStatus,"append-to-body":!0,title:"本地上传",width:"40%"},on:{"update:visible":function(t){e.dialogLocalStatus=t},close:e.dialogClose}},[i("el-form",{ref:"form",attrs:{"label-width":"120px"}},[i("el-tree",{ref:"tree",staticStyle:{margin:"0 0 20px 30px"},attrs:{data:e.folderListData,props:e.defaultProps,"default-expand-all":!1},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){t.node;var a=t.data;return i("span",{},[i("span",{staticStyle:{color:"black"}},[i("img",{attrs:{src:o("PxHo"),alt:""}}),e._v("\n            "+e._s(a.folderName)+"\n          ")])])}}])}),e._v(" "),i("el-form-item",{attrs:{label:"选择文件夹："}},[e._v(e._s(e.folderName))]),e._v(" "),void 0!=e.versionData?i("el-form-item",{attrs:{label:"版本备注："}},[i("el-input",{attrs:{placeholder:"请输入备注"},model:{value:e.fileRemark,callback:function(t){e.fileRemark=t},expression:"fileRemark"}})],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"选择文件类型："}},[i("el-select",{attrs:{placeholder:"请选择文件类型"},on:{change:e.selectChanged},model:{value:e.fileTypeId,callback:function(t){e.fileTypeId=t},expression:"fileTypeId"}},e._l(e.fileTypeList,function(e,t){return i("el-option",{key:t,attrs:{label:e.typeName,value:e.typeId}})}))],1),e._v(" "),i("el-form-item",{attrs:{label:"上传文件："}},[i("el-upload",{staticClass:"upload-demo",attrs:{headers:e.uploadHeaders,action:e.uploadAction,"before-upload":e.beforeUpload,"on-success":e.onSuccess,drag:"",multiple:""}},[i("i",{staticClass:"el-icon-upload"}),e._v(" "),i("div",{staticClass:"el-upload__text"},[e._v("\n            将文件拖到此处，或\n            "),i("em",[e._v("点击上传")])])])],1)],1)],1)],1)},[],!1,null,"7a444b89",null);d.options.__file="Upload.vue";t.default=d.exports}}]);