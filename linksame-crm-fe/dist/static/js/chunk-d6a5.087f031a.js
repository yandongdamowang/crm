(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-d6a5","chunk-3a8a","chunk-3a8ac","chunk-3a8ace","chunk-e5b0"],{"+JiW":function(t,e,s){"use strict";var a=s("P/2M");s.n(a).a},"20cK":function(t,e,s){"use strict";var a=s("KrW/");s.n(a).a},"3yi6":function(t,e,s){"use strict";var a=s("7Qib"),i=s("KzkL"),n={name:"FollowRecordCell",components:{CRMFullScreenDetail:function(){return Promise.all([s.e("chunk-66f9"),s.e("chunk-41da"),s.e("chunk-1664"),s.e("chunk-3a8ace")]).then(s.bind(null,"uMjE"))}},props:{item:{type:Object,default:function(){return{}}},crmType:{type:String,default:""},index:[String,Number]},data:function(){return{showFullDetail:!1,relationID:"",relationCrmType:""}},computed:{},mounted:function(){},methods:{previewImg:function(t,e){this.$bus.emit("preview-image-bus",{index:e,data:t.map(function(t,e,s){return t.url=t.filePath,t})})},downloadFile:function(t){Object(a.b)({path:t.filePath,name:t.name})},handleCommand:function(t){var e=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(i.p)({recordId:e.item.recordId}).then(function(s){e.$emit("on-handle",{type:t,data:{item:e.item,index:e.index}}),e.$message.success("操作成功")}).catch(function(){})}).catch(function(){e.$message({type:"info",message:"已取消操作"})})},checkRelationDetail:function(t,e){this.relationID=e,this.relationCrmType=t,this.showFullDetail=!0}}},o=(s("MEpo"),s("KHd+")),c=Object(o.a)(n,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"fl-c"},[a("flexbox",{staticClass:"fl-h"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:{img:t.item.userImg,realname:t.item.realname},expression:"{img: item.userImg, realname: item.realname}"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.item.userImg),expression:"$options.filters.filterUserLazyImg(item.userImg)",arg:"background-image"}],staticClass:"div-photo fl-h-img"}),t._v(" "),a("div",{staticClass:"fl-h-b"},[a("div",{staticClass:"fl-h-name"},[t._v(t._s(t.item.realname))]),t._v(" "),a("div",{staticClass:"fl-h-time"},[t._v(t._s(t.item.createTime))])]),t._v(" "),a("flexbox",{staticClass:"fl-h-mark"},[a("img",{staticClass:"fl-h-mark-img",attrs:{src:s("N0PQ")}}),t._v(" "),a("div",{staticClass:"fl-h-mark-name"},[t._v("跟进记录")])]),t._v(" "),a("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[a("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD","margin-left":"8px"}}),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"delete"}},[t._v("删除")])],1)],1)],1),t._v(" "),a("div",{staticClass:"fl-b"},[a("div",{staticClass:"fl-b-content"},[t._v(t._s(t.item.content))]),t._v(" "),t.item.img&&t.item.img.length>0?a("flexbox",{staticClass:"fl-b-images",attrs:{wrap:"wrap"}},t._l(t.item.img,function(e,s){return a("div",{directives:[{name:"lazy",rawName:"v-lazy:background-image",value:e.filePath,expression:"file.filePath",arg:"background-image"}],key:e.filePath,staticClass:"fl-b-img-item",on:{click:function(e){t.previewImg(t.item.img,s)}}})})):t._e(),t._v(" "),t.item.file&&t.item.file.length>0?a("div",{staticClass:"fl-b-files"},t._l(t.item.file,function(e,i){return a("flexbox",{key:i,staticClass:"cell"},[a("img",{staticClass:"cell-head",attrs:{src:s("6KEE")}}),t._v(" "),a("div",{staticClass:"cell-body"},[t._v(t._s(e.name)),a("span",{staticStyle:{color:"#ccc"}},[t._v("（"+t._s(e.size)+"）")])]),t._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:function(s){t.downloadFile(e)}}},[t._v("下载")])],1)})):t._e(),t._v(" "),t.item.category||t.item.nextTime?a("div",{staticClass:"follow"},[t.item.category?a("span",{staticClass:"follow-info"},[t._v(t._s(t.item.category))]):t._e(),t._v(" "),t.item.nextTime?a("span",{staticClass:"follow-info"},[t._v(t._s(t.item.nextTime))]):t._e()]):t._e(),t._v(" "),t.item.contactsList&&t.item.contactsList.length>0?a("div",{staticClass:"fl-b-other"},[a("div",{staticClass:"fl-b-other-name"},[t._v("关联联系人")]),t._v(" "),a("div",t._l(t.item.contactsList,function(e,s){return a("flexbox",{key:s,staticClass:"cell",nativeOn:{click:function(s){t.checkRelationDetail("contacts",e.contactsId)}}},[a("i",{staticClass:"wukong wukong-contacts cell-head crm-type",style:{opacity:0==s?1:0}}),t._v(" "),a("div",{staticClass:"cell-body",staticStyle:{color:"#6394E5",cursor:"pointer"}},[t._v(t._s(e.name))])])}))]):t._e(),t._v(" "),t.item.businessList&&t.item.businessList.length>0?a("div",{staticClass:"fl-b-other"},[a("div",{staticClass:"fl-b-other-name"},[t._v("关联商机")]),t._v(" "),a("div",t._l(t.item.businessList,function(e,s){return a("flexbox",{key:s,staticClass:"cell",nativeOn:{click:function(s){t.checkRelationDetail("business",e.businessId)}}},[a("i",{staticClass:"wukong wukong-business cell-head crm-type",style:{opacity:0==s?1:0}}),t._v(" "),a("div",{staticClass:"cell-body",staticStyle:{color:"#6394E5",cursor:"pointer"}},[t._v(t._s(e.businessName))])])}))]):t._e(),t._v(" "),t._t("default")],2),t._v(" "),a("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,"crm-type":t.relationCrmType,id:t.relationID},on:{"update:visible":function(e){t.showFullDetail=e}}})],1)},[],!1,null,"6af54424",null);c.options.__file="FollowRecordCell.vue";e.a=c.exports},"5tqf":function(t,e,s){"use strict";s.d(e,"b",function(){return i}),s.d(e,"a",function(){return n}),s.d(e,"c",function(){return o});var a=s("t3Un");function i(t){return Object(a.a)({url:"workTrash/queryList",method:"post",data:t})}function n(t){return Object(a.a)({url:"workTrash/deleteTask",method:"post",data:t})}function o(t){return Object(a.a)({url:"workTrash/restore",method:"post",data:t})}},"6vqz":function(t,e,s){},"7acB":function(t,e,s){},"7z+D":function(t,e,s){"use strict";var a=s("ExMk"),i=s("Ew9n"),n=s("EP+0"),o=s("3biH"),c=s("Er7M"),l=s("O1Uw"),r=s("7Qib"),d={name:"ExamineDetail",components:{SlideView:i.a,CreateSections:n.a,ExamineInfo:o.a,RelatedBusinessCell:c.a,CRMFullScreenDetail:function(){return s.e("chunk-e5b0").then(s.bind(null,"uMjE"))},FileCell:l.a},props:{id:[String,Number],noListenerClass:{type:Array,default:function(){return["list-box"]}}},data:function(){return{loading:!1,categoryId:"",type:"",detail:{examineRecordId:""},list:[],categoryName:"",fileList:[],imgList:[],travelList:[],travelField:[{prop:"vehicle",label:"交通工具"},{prop:"trip",label:"单程往返"},{prop:"startAddress",label:"出发城市"},{prop:"endAddress",label:"目的城市"},{prop:"startTime",label:"开始时间"},{prop:"endTime",label:"结束时间"},{prop:"duration",label:"时长（天）"},{prop:"description",label:"备注"}],expensesField:[{prop:"startAddress",label:"出发城市"},{prop:"endAddress",label:"目的城市"},{prop:"startTime",label:"开始时间"},{prop:"endTime",label:"结束时间"},{prop:"traffic",label:"交通费（元）"},{prop:"stay",label:"住宿费（元）"},{prop:"diet",label:"餐饮费（元）"},{prop:"other",label:"其他费用（元）"},{prop:"description",label:"费用明细描述"}],relatedID:"",relatedCRMType:"",showRelatedDetail:!1}},computed:{relatedListData:function(){return{contacts:this.detail.contactsList||[],customer:this.detail.customerList||[],business:this.detail.businessList||[],contract:this.detail.contractList||[]}}},watch:{id:function(t){this.getDetial()}},mounted:function(){this.getDetial()},methods:{getBaseInfo:function(){var t=this;this.loading=!0,Object(a.a)({examineId:this.id,isDetail:1}).then(function(e){t.list=e.data,t.loading=!1}).catch(function(){t.loading=!1})},getDetial:function(){var t=this;this.loading=!0,Object(a.j)({examineId:this.id}).then(function(e){t.loading=!1,t.categoryId=e.data.categoryId,t.type=e.data.type,t.getBaseInfo(),t.detail=e.data,t.categoryName=t.detail.category,t.fileList=t.detail.file,t.imgList=t.detail.img,t.travelList=t.detail.examineTravelList}).catch(function(){t.loading=!1})},hideView:function(){this.$emit("hide-view")},checkRelatedDetail:function(t,e){this.relatedID=e[t+"Id"],this.relatedCRMType=t,this.showRelatedDetail=!0},handleFile:function(t,e,s){if("preview"===t){if(e&&e.length>0){var a=e.map(function(t){return t.url=t.filePath,t});this.$bus.emit("preview-image-bus",{index:s,data:a})}}else"download"===t&&Object(r.b)({path:e.filePath,name:e.name})},imgZoom:function(t,e){this.$bus.emit("preview-image-bus",{index:e,data:t.map(function(t,e,s){return{url:t.filePath,name:t.name}})})},downloadFile:function(t){Object(r.b)({path:t.filePath,name:t.name})},examineHandle:function(t){this.$store.dispatch("GetOAMessageNum","examine"),this.$emit("on-examine-handle",t)}}},u=(s("aoc0"),s("KHd+")),m=Object(u.a)(d,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("slide-view",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"d-view",attrs:{"listener-ids":["workbench-main-container"],"no-listener-class":t.noListenerClass,"body-style":{padding:"10px 30px",height:"100%"}},on:{"side-close":t.hideView}},[a("flexbox",{staticStyle:{height:"100%"},attrs:{orient:"vertical"}},[a("flexbox",{staticClass:"detail-header"},[a("div",{staticClass:"header-name"},[t._v(t._s(t.categoryName))]),t._v(" "),a("img",{staticClass:"header-close",attrs:{src:s("cjwK")},on:{click:t.hideView}})]),t._v(" "),a("div",{staticClass:"detail-body"},[a("flexbox",{attrs:{gutter:0,align:"stretch",wrap:"wrap"}},t._l(t.list,function(e,i){return"examine_cause"!==e.formType&&"business_cause"!==e.formType?a("flexbox-item",{key:i,staticClass:"b-cell",attrs:{span:.5}},["checkbox"===e.formType?a("flexbox",{staticClass:"b-cell-b",attrs:{align:"stretch"}},[a("div",{staticClass:"b-cell-name"},[t._v(t._s(e.name))]),t._v(" "),a("div",{staticClass:"b-cell-value"},[a("flexbox",{staticStyle:{padding:"0px 10px 10px 0px"},attrs:{gutter:0,wrap:"wrap"}},t._l(e.value,function(e,s){return a("div",{key:s},[t._v("\n                  "+t._s(e)+"  \n                ")])}))],1)]):"file"===e.formType?a("flexbox",{staticClass:"b-cell-b",attrs:{align:"stretch"}},[a("div",{staticClass:"b-cell-name"},[t._v(t._s(e.name))]),t._v(" "),a("div",{staticClass:"b-cell-value"},t._l(e.value,function(i,n){return a("flexbox",{key:n,staticClass:"f-item"},[a("img",{staticClass:"f-img",attrs:{src:s("6KEE")}}),t._v(" "),a("div",{staticClass:"f-name"},[t._v(t._s(i.name.length>15?i.name.substring(0,15)+"...":i.name+"("+i.size+")"))]),t._v(" "),a("el-button",{attrs:{type:"text"},nativeOn:{click:function(s){t.handleFile("preview",e.value,n)}}},[t._v("预览")]),t._v(" "),a("el-button",{attrs:{type:"text"},nativeOn:{click:function(e){t.handleFile("download",i,n)}}},[t._v("下载")])],1)}))]):a("flexbox",{staticClass:"b-cell-b",attrs:{align:"stretch"}},[a("div",{staticClass:"b-cell-name"},[t._v(t._s(e.name))]),t._v(" "),a("div",{staticClass:"b-cell-value"},[t._v(t._s(e.value))])])],1):t._e()})),t._v(" "),t.fileList.length>0||t.imgList.length>0?a("div",{staticClass:"accessory"},[a("div",{staticClass:"upload-img-box"},t._l(t.imgList,function(e,s){return a("div",{key:s,staticClass:"img-list",on:{click:function(e){t.imgZoom(t.imgList,s)}}},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.filePath,expression:"imgItem.filePath"}],key:e.filePath})])})),t._v(" "),a("div",{staticClass:"accessory-box"},t._l(t.fileList,function(t,e){return a("file-cell",{key:e,attrs:{data:t,"cell-index":e}})}))]):t._e(),t._v(" "),t.type&&3==t.type&&t.travelList&&t.travelList.length>0?a("create-sections",{staticClass:"create-sections",attrs:{title:"行程"}},[a("el-table",{staticStyle:{"font-size":"13px"},attrs:{data:t.travelList,align:"center","header-align":"center",stripe:""}},t._l(t.travelField,function(e,s){return a("el-table-column",{key:s,attrs:{prop:e.prop,label:e.label,"show-overflow-tooltip":""},scopedSlots:t._u([{key:"header",fn:function(e){return[a("div",{staticClass:"table-head-name"},[t._v(t._s(e.column.label))])]}}])})}))],1):t._e(),t._v(" "),t.type&&5==t.type&&t.travelList&&t.travelList.length>0?a("create-sections",{staticClass:"create-sections",attrs:{title:"报销"}},[a("el-table",{staticStyle:{"font-size":"13px"},attrs:{data:t.travelList,align:"center","header-align":"center",stripe:""}},[t._l(t.expensesField,function(e,s){return a("el-table-column",{key:s,attrs:{prop:e.prop,label:e.label,"show-overflow-tooltip":""},scopedSlots:t._u([{key:"header",fn:function(e){return[a("div",{staticClass:"table-head-name"},[t._v(t._s(e.column.label))])]}}])})}),t._v(" "),a("el-table-column",{attrs:{label:"发票",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("flexbox",{attrs:{justify:"center"}},[a("el-button",{attrs:{type:"text"},nativeOn:{click:function(s){t.handleFile("preview",e.row.img,0)}}},[t._v(t._s(e.row.img.length)+"张")])],1)]}}])})],2)],1):t._e(),t._v(" "),t.relatedListData.contacts.length>0||t.relatedListData.customer.length>0||t.relatedListData.business.length>0||t.relatedListData.contract.length>0?a("create-sections",{staticClass:"create-sections",attrs:{title:"关联业务"}},[a("div",{staticClass:"related-business create-sections-content"},t._l(t.relatedListData,function(e,s){return a("div",{key:s},t._l(e,function(e,i){return a("related-business-cell",{key:i,attrs:{data:e,"cell-index":i,type:s,"show-foot":!1},nativeOn:{click:function(a){t.checkRelatedDetail(s,e)}}})}))}))]):t._e(),t._v(" "),a("create-sections",{staticClass:"create-sections",attrs:{title:"审核信息"}},[a("examine-info",{staticClass:"create-sections-content",attrs:{id:t.id,"record-id":t.detail.examineRecordId,"examine-type":"oa_examine"},on:{"on-handle":t.examineHandle}})],1)],1)],1),t._v(" "),a("c-r-m-full-screen-detail",{attrs:{visible:t.showRelatedDetail,"crm-type":t.relatedCRMType,id:t.relatedID},on:{"update:visible":function(e){t.showRelatedDetail=e}}})],1)},[],!1,null,"81c16166",null);m.options.__file="examineDetail.vue";e.a=m.exports},"8bpV":function(t,e,s){},"8wby":function(t,e,s){},Ad61:function(t,e,s){"use strict";var a=s("HYx/");s.n(a).a},BKBN:function(t,e,s){"use strict";var a=s("flx0");s.n(a).a},DcnZ:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjhDRDcyQTY3RTE2RTExRThCRTI2OUUxNDM4MTM1RjMzIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjhDRDcyQTY4RTE2RTExRThCRTI2OUUxNDM4MTM1RjMzIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OENENzJBNjVFMTZFMTFFOEJFMjY5RTE0MzgxMzVGMzMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OENENzJBNjZFMTZFMTFFOEJFMjY5RTE0MzgxMzVGMzMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6YLrWcAAAAYklEQVR42mL8//8/AzUBEwOVwaiBg9BAlrNnz9LEhZ5A/AyKPdHUkCTHeObMGQaogCRU0XMglkLSRJIctjBkxOMjgnIwA1OA+AUQPwXiZDSFJMnBvEw1wDhaOIwaSDoACDAAtBYiKbAuMEoAAAAASUVORK5CYII="},"HYx/":function(t,e,s){},Ic4M:function(t,e,s){},"KrW/":function(t,e,s){},LC2R:function(t,e,s){"use strict";var a=s("Ic4M");s.n(a).a},MEpo:function(t,e,s){"use strict";var a=s("7acB");s.n(a).a},N0PQ:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjZGRjBCRTYxRTBBNzExRTg5QkREOEQxRjlDMkUxOUExIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjZGRjBCRTYyRTBBNzExRTg5QkREOEQxRjlDMkUxOUExIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NkZGMEJFNUZFMEE3MTFFODlCREQ4RDFGOUMyRTE5QTEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NkZGMEJFNjBFMEE3MTFFODlCREQ4RDFGOUMyRTE5QTEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz704RrgAAABwUlEQVR42uSXz0sCQRTH36h1sGNlaHjpVJoHC0KCOnVJOwSdqmM/6NZ/EF071rluQaduGQWd9BZEqWBhQQQmHYIQikDU6bs6G8Oy4q7sskYPPuzOzFu+++a9mZ1lnHNywlzkkDkm7JEb7/m8rWIDoVBHEc+DEuAaSmLMtqk+An6dfr8Ys0T4BHxJUbUzJq6q/yc47kR4CXg1fevgTcf3Faxp+vrAsuHikqxH054A5y2mWvYxnEaPwZTc/Kl1zJPJBt27gbR667YlnUjYMNWMORMxi8edETZhH+AZ9IIx4LZb+A5sieskGALfYMWW4hIFdQtmwJyIVt5gruEziucfrF5OVbAKZsGpzq42BVIQH+6suFovlRRQojnTzWethl73IO52wYaVEd+DcTDSaFUqRPV6c6RYJJ5ON8WJFqwuLkWl/7cWMhmE4SLm8xHP5YhFIkrEJPsYibhqQDgKCur3moXDROUy8Wy2KRoMqn5PZoQLBoSnxTf7otHyeonFYsSiUVlUsUMzwttAOfnV2my3e2ATvKjiFAjIPpdg30yOr0DYRL6VpbMDFoEPPIpz2EGrl2fyn0S3Hm8tNfbv/p1+BBgA+Vdv2Iz9D6cAAAAASUVORK5CYII="},OPCT:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjVENDNERTkxRTA5QjExRThBQkRDQjRERjVBMjY3MzE0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjVENDNERTkyRTA5QjExRThBQkRDQjRERjVBMjY3MzE0Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NUQ0M0RFOEZFMDlCMTFFOEFCRENCNERGNUEyNjczMTQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NUQ0M0RFOTBFMDlCMTFFOEFCRENCNERGNUEyNjczMTQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7c1/V2AAABIElEQVR42mL8//8/AwicPXuWgVxgbGwMZzMRUBsGxBeB+AXITigfL2DBIxcCxHlA7AnEz4CYB4gnQ+VW4dKEz4UNQBwNNQwEvgBxBhAn4XMhPgMFgPghmthPIP5NroF/cYgzkmsgMw7x/+Qa+AGIZbBEIgu5BjYC8VIgloLyQbE8E4gXkJtsVkMt3Ak1DOTiDiBeSa6BDFDNK0nJNdi8rArEa4H4IzQC0PFHqLwqMQaqA/ERID4IxIrQJIKOFaDyR6Dq8Xq5DYon4fHVe6g8J1RtMD4XugDxYiKDazYQu5GSbMgC6AbuAeJYIvWmAPEuQmFYDQ3w/1Cvv8dikCDU0mIgtifkwhtAbAdV+BBHsnkIlbeDqieYsG+ixxwpACDAAIZEQR7SM/O0AAAAAElFTkSuQmCC"},"P/2M":function(t,e,s){},QJC7:function(t,e,s){"use strict";var a=s("3yi6"),i=s("5tgW"),n=s("vG5h"),o=s("qbf4"),c=s("UcQx"),l=s("6zBA"),r={name:"RecordLog",components:{FollowRecordCell:a.a},props:{id:[String,Number],crmType:{type:String,default:""}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[]}},computed:{},watch:{id:function(t){this.refreshList()}},mounted:function(){var t=this;this.$bus.on("follow-log-refresh",function(e){"record-log"==e.type&&t.refreshList()});var e=document.getElementById("follow-log-content");e.onscroll=function(){var s=e.scrollTop+e.clientHeight-e.scrollHeight;Math.abs(s)<10&&1==t.loadMoreLoading&&(t.isPost?t.loadMoreLoading=!1:(t.isPost=!0,t.page++,t.getList()))},this.getList()},activated:function(){},deactivated:function(){},beforeDestroy:function(){this.$bus.off("follow-log-refresh")},methods:{getList:function(){var t=this;this.loading=!0;var e={customer:n.v,leads:i.i,contacts:o.j,business:c.j,contract:l.j}[this.crmType],s={page:this.page,limit:10};s[this.crmType+"Id"]=this.id,e(s).then(function(e){t.list=t.list.concat(e.data),e.data.length<10?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.loading=!1,t.isPost=!1}).catch(function(){t.isPost=!1,t.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},cellHandle:function(t){"delete"==t.type&&this.list.splice(t.data.index,1)}}},d=(s("+JiW"),s("KHd+")),u=Object(d.a)(r,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[s("div",{directives:[{name:"empty",rawName:"v-empty",value:0===t.list.length,expression:"list.length === 0"}]},[s("div",{staticClass:"log-items"},[t._l(t.list,function(e,a){return s("follow-record-cell",{key:a,attrs:{item:e,index:a,"crm-type":t.crmType},on:{"on-handle":t.cellHandle}})}),t._v(" "),s("div",{staticClass:"load"},[s("el-button",{attrs:{loading:t.loadMoreLoading,type:"text"}},[t._v(t._s(t.loadMoreLoading?"加载更多":"没有更多了"))])],1)],2)])])},[],!1,null,"05b8da62",null);u.options.__file="RecordLog.vue";e.a=u.exports},"RU/L":function(t,e,s){s("Rqdy");var a=s("WEpk").Object;t.exports=function(t,e,s){return a.defineProperty(t,e,s)}},Rqdy:function(t,e,s){var a=s("Y7ZC");a(a.S+a.F*!s("jmDH"),"Object",{defineProperty:s("2faE").f})},SEkw:function(t,e,s){t.exports={default:s("RU/L"),__esModule:!0}},UEWd:function(t,e,s){"use strict";var a=s("7Qib"),i=s("KTTK"),n={name:"MixAdd",components:{CrmRelative:s("mkuN").a},props:{showRelativeBusiness:{type:Boolean,default:!1},showRelativeContacts:{type:Boolean,default:!1},id:[String,Number],crmType:{type:String,default:""}},data:function(){return{content:"",inputAutosize:{minRows:1,maxRows:6},barItems:[{img:s("S1Xc"),title:"图片",type:"img",data:"image/*"},{img:s("rl4O"),title:"附件",type:"file",data:"*.*"}],imgFiles:[],files:[],business:[],contacts:[],showRelativeType:"",batchId:""}},computed:{},mounted:function(){this.showRelativeBusiness&&this.barItems.push({img:s("i91G"),title:"关联商机",type:"business",show:!1}),this.showRelativeContacts&&this.barItems.push({img:s("OPCT"),title:"关联联系人",type:"contacts",show:!1}),this.$on("submit-info",function(){this.$emit("mixadd-info",{content:this.content,files:this.files,images:this.imgFiles,business:this.business,contacts:this.contacts,batchId:this.batchId})})},beforeDestroy:function(){this.$off("submit-info")},methods:{resetInfo:function(){this.content="",this.imgFiles=[],this.files=[],this.business=[],this.contacts=[],this.showRelativeType="",this.batchId=""},checkRelativeInfos:function(t){"business"==this.showRelativeType?this.business=t.data:"contacts"==this.showRelativeType&&(this.contacts=t.data)},barClick:function(t){this.showRelativeType=t.type,"business"==t.type?t.show=!0:"contacts"==t.type&&(t.show=!0)},uploadFile:function(t){var e=this,s=t.target.files;if(s.length){for(var a=0;a<s.length;a++){if(-1==s[a].type.indexOf("image")&&"img"==this.showRelativeType)return void this.$message.error("请上传正确的文件类型")}var i="image/*"==t.target.accept?"img":"file",n=s[0];this.sendFileRequest(n,i,function(){for(var a=1;a<s.length;a++){var n=s[a];e.sendFileRequest(n,i)}t.target.value=""})}},sendFileRequest:function(t,e,s){var n=this,o={file:t,type:e};this.batchId&&(o.batchId=this.batchId),Object(i.d)(o).then(function(i){""==n.batchId&&(n.batchId=i.batchId),i.size=Object(a.d)(t.size),"img"==e?n.imgFiles.push(i):(i.icon=Object(a.g)(t),n.files.push(i)),s&&s()}).catch(function(){})},deleteAllImg:function(){this.imgFiles=[]},deleteImgOrFile:function(t,e,s){var a=this;Object(i.b)({id:e.fileId}).then(function(e){"image"==t?a.imgFiles.splice(s,1):a.files.splice(s,1),a.$message.success("操作成功")}).catch(function(){})},mouseImgOver:function(t,e){t.showDelete=!0,this.$set(this.imgFiles,e,t)},mouseImgLeave:function(t,e){t.showDelete=!1,this.$set(this.imgFiles,e,t)},inputFocus:function(){var t=this;this.inputAutosize={minRows:3,maxRows:6},this.$nextTick(function(){t.$refs.textarea.resizeTextarea()})}}},o=(s("kblT"),s("KHd+")),c=Object(o.a)(n,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mix-container"},[a("div",{staticClass:"i-cont"},[a("el-input",{ref:"textarea",attrs:{autosize:t.inputAutosize,type:"textarea",clearable:"",resize:"none",placeholder:"请输入内容"},on:{focus:t.inputFocus},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),t._v(" "),t.imgFiles.length>0?a("section",{staticClass:"img-cont"},[a("flexbox",{attrs:{wrap:"wrap"}},[t._l(t.imgFiles,function(e,s){return a("div",{key:s,staticClass:"img-item",style:{"background-image":"url("+e.url+")"},on:{mouseover:function(a){t.mouseImgOver(e,s)},mouseleave:function(a){t.mouseImgLeave(e,s)}}},[e.showDelete?a("div",{staticClass:"img-delete",on:{click:function(a){t.deleteImgOrFile("image",e,s)}}},[t._v("×")]):t._e()])}),t._v(" "),a("div",{staticClass:"img-item-add"},[a("input",{staticClass:"img-item-iput",attrs:{type:"file",accept:"image/*",multiple:""},on:{change:t.uploadFile}})])],2),t._v(" "),a("div",{staticClass:"img-bar",on:{click:t.deleteAllImg}},[t._v("全部删除")])],1):t._e(),t._v(" "),t.files.length>0?a("section",{staticClass:"file-cont"},[a("flexbox",{staticClass:"f-header"},[a("img",{staticClass:"f-logo",attrs:{src:s("rl4O")}}),t._v(" "),a("div",{staticClass:"f-name"},[t._v("附件")])]),t._v(" "),a("div",{staticClass:"f-body"},t._l(t.files,function(e,s){return a("flexbox",{key:s,staticClass:"f-item"},[a("img",{staticClass:"f-img",attrs:{src:e.icon}}),t._v(" "),a("div",{staticClass:"f-name"},[t._v(t._s(e.name+"("+e.size+")"))]),t._v(" "),a("div",{staticClass:"close-button",on:{click:function(a){t.deleteImgOrFile("file",e,s)}}},[t._v("×")])])})),t._v(" "),a("div",{staticClass:"img-bar",on:{click:function(e){t.files=[]}}},[t._v("全部删除")])],1):t._e(),t._v(" "),t.business.length>0?a("section",{staticClass:"c-cont"},[a("flexbox",{staticClass:"c-header"},[a("img",{staticClass:"c-logo",attrs:{src:s("i91G")}}),t._v(" "),a("div",{staticClass:"c-name"},[t._v("商机")])]),t._v(" "),a("div",{staticClass:"c-body"},[a("flexbox",{attrs:{wrap:"wrap"}},t._l(t.business,function(e,s){return a("flexbox",{key:s,staticClass:"c-item"},[a("div",{staticClass:"c-item-name"},[t._v(t._s(e.businessName))]),t._v(" "),a("div",{staticClass:"c-item-close",on:{click:function(e){t.business.splice(s,1)}}},[t._v("×")])])}))],1)],1):t._e(),t._v(" "),t.contacts.length>0?a("section",{staticClass:"c-cont"},[a("flexbox",{staticClass:"c-header"},[a("img",{staticClass:"c-logo",attrs:{src:s("OPCT")}}),t._v(" "),a("div",{staticClass:"c-name"},[t._v("联系人")])]),t._v(" "),a("div",{staticClass:"c-body"},[a("flexbox",{attrs:{wrap:"wrap"}},t._l(t.contacts,function(e,s){return a("flexbox",{key:s,staticClass:"c-item"},[a("div",{staticClass:"c-item-name"},[t._v(t._s(e.name))]),t._v(" "),a("div",{staticClass:"c-item-close",on:{click:function(e){t.contacts.splice(s,1)}}},[t._v("×")])])}))],1)],1):t._e(),t._v(" "),a("flexbox",{staticClass:"bar-cont"},[t._l(t.barItems,function(e,s){return["img"==e.type||"file"==e.type?a("flexbox",{key:s,staticClass:"bar-item",nativeOn:{click:function(s){t.barClick(e)}}},[a("input",{staticClass:"bar-input",attrs:{accept:e.data,type:"file",multiple:""},on:{change:t.uploadFile}}),t._v(" "),a("img",{staticClass:"bar-img",attrs:{src:e.img}}),t._v(" "),a("div",{staticClass:"bar-title"},[t._v(t._s(e.title))])]):a("el-popover",{key:s,attrs:{placement:"bottom",width:"700","popper-class":"no-padding-popover",trigger:"click"},model:{value:e.show,callback:function(s){t.$set(e,"show",s)},expression:"item.show"}},[a("crm-relative",{ref:"crmrelative",refInFor:!0,attrs:{show:e.show,radio:!1,action:{type:"condition",data:{moduleType:t.crmType,customerId:t.id}},"selected-data":"business"==e.type?{business:t.business}:{contacts:t.contacts},"crm-type":e.type},on:{close:function(t){e.show=!1},changeCheckout:t.checkRelativeInfos}}),t._v(" "),a("flexbox",{staticClass:"bar-item",attrs:{slot:"reference"},nativeOn:{click:function(s){t.barClick(e)}},slot:"reference"},[a("img",{staticClass:"bar-img",attrs:{src:e.img}}),t._v(" "),a("div",{staticClass:"bar-title"},[t._v(t._s(e.title))])])],1)]})],2)],1)},[],!1,null,"e146eed2",null);c.options.__file="MixAdd.vue";e.a=c.exports},UZZ0:function(t,e,s){"use strict";var a=s("8bpV");s.n(a).a},WLv5:function(t,e,s){"use strict";var a=s("huB7");s.n(a).a},YEIV:function(t,e,s){"use strict";e.__esModule=!0;var a=function(t){return t&&t.__esModule?t:{default:t}}(s("SEkw"));e.default=function(t,e,s){return e in t?(0,a.default)(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}},aoc0:function(t,e,s){"use strict";var a=s("8wby");s.n(a).a},cEue:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjYzNEQ2RDE3MzRFNTExRTlCRjI5QUEzN0UzNDcxMUZDIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjYzNEQ2RDE4MzRFNTExRTlCRjI5QUEzN0UzNDcxMUZDIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NjM0RDZEMTUzNEU1MTFFOUJGMjlBQTM3RTM0NzExRkMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NjM0RDZEMTYzNEU1MTFFOUJGMjlBQTM3RTM0NzExRkMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4/GDLpAAABSElEQVR42oySvU4CURCFD/cVVHp+X0Cihp4QXkBXDBW/L0HCW0CgJGC0tSCEghJNtLDmr8ME9QUs0DPu3XXvLmaZ5BQ7d767c89M5LtehycUdUVdUxfUCfVOPVK31B21c4ojHjhO3VOn+D9eqEtq5fzJAWchIPT5TNf/wkq3E8VhEdX1SkCLyrhHrRYQi5nlySTQbHozUm8JXDIKBwOg0WBj8T+wWgWGQ38HJTFM3Dw20qkUUKkA4zGQzwPdLrBc+uE3FQAl5nNgMqGvNHY02gdKHAn8EUin00AuR1voS6EAJBL74E+BnwNguQx0OsB0CvR6QK1mv92MV4H7Rsqi+e02sF7b34uFfUGx6If7Yphc8GSMKzyk23Old1VmvT0Q3Or6nbOeYmdW7y5Cdjur693ddi44o+RxD9SG+pJ56u8bfe7O7UeAAQCsHFF+l0CFAgAAAABJRU5ErkJggg=="},fCst:function(t,e,s){"use strict";var a=s("FyfS"),i=s.n(a),n=s("QbLZ"),o=s.n(n),c=s("Xjjk"),l=s.n(c),r=s("F/D6"),d=s("sl8O"),u=s("KTTK"),m=s("5tqf"),h=s("utuE"),p={props:{newTagTitle:String,newTagInput:String,bgColorProps:String},data:function(){return{colorList:["#53D397","#20C1BD","#58DADA","#0FC9E7","#3498DB","#4586FF","#8983F3","#AEA1EA","#FF6699","#F24D70","#FF6F6F"],input:this.newTagInput,showBgColor:""}},watch:{bgColorProps:function(t){this.showBgColor=t||"#53D397"}},mounted:function(){this.showBgColor=this.bgColorProps||"#53D397"},methods:{back:function(){this.$emit("back")},close:function(){this.$emit("close")},changeColor:function(t){this.$emit("changeColor",t)},tagCreateSubmit:function(){this.$emit("tagCreateSubmit",this.input,this.showBgColor)},tagCancel:function(){this.$emit("tagCancel")}}},v=(s("BKBN"),s("KHd+")),g=Object(v.a)(p,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"new-tag-dialog"},[s("div",{staticClass:"title"},[s("span",{staticClass:"el-icon-arrow-left",on:{click:t.back}}),t._v(" "),s("span",[t._v(t._s(t.newTagTitle))]),t._v(" "),s("span",{staticClass:"el-icon-close rt",on:{click:t.close}})]),t._v(" "),s("div",{staticClass:"search"},[s("el-input",{attrs:{maxlength:10,size:"mini",placeholder:"输入标签名，最多十个字符"},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}}),t._v(" "),s("span",{staticClass:"checked-color",style:{background:t.showBgColor}})],1),t._v(" "),s("div",{staticClass:"color-box"},t._l(t.colorList,function(e,a){return s("span",{key:a,style:{background:e},on:{click:function(s){t.changeColor(e)}}})})),t._v(" "),s("div",{staticClass:"footer"},[s("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.tagCreateSubmit}},[t._v("保存")]),t._v(" "),s("el-button",{attrs:{size:"medium"},on:{click:t.tagCancel}},[t._v("取消")])],1)])},[],!1,null,"b8f3e1f0",null);g.options.__file="newTag.vue";var b=g.exports,f={props:{editTagList:Array},data:function(){return{inputModel:"",list:this.editTagList}},watch:{inputModel:function(t){this.list=this.editTagList.filter(function(e){return e.name.indexOf(t)>-1})}},methods:{back:function(){this.$emit("back")},close:function(){this.$emit("close")},deleteBtn:function(t){this.$emit("deleteBtn",t)},editBtn:function(t){this.$emit("editBtn",t)}}},k=(s("Ad61"),Object(v.a)(f,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"edit-tag-dialog"},[s("div",{staticClass:"title"},[s("span",{staticClass:"el-icon-arrow-left",on:{click:t.back}}),t._v(" "),s("span",[t._v("标签管理")]),t._v(" "),s("span",{staticClass:"el-icon-close rt",on:{click:t.close}})]),t._v(" "),s("div",{staticClass:"search"},[s("el-input",{attrs:{maxlength:10,size:"mini",placeholder:"输入标签名，最多十个字符"},model:{value:t.inputModel,callback:function(e){t.inputModel=e},expression:"inputModel"}})],1),t._v(" "),s("div",{staticClass:"content"},t._l(t.list,function(e,a){return s("div",{key:a,staticClass:"tag-list"},[s("span",{staticClass:"tag-name",style:{background:e.color?e.color:"#ccc"}},[t._v("\n        "+t._s(e.name.length>10?e.name.substring(0,10)+"...":e.name)+"\n      ")]),t._v(" "),s("div",{staticClass:"rt"},[s("span",{staticClass:"el-icon-edit",on:{click:function(s){t.editBtn(e)}}}),t._v(" "),s("span",{staticClass:"el-icon-delete",on:{click:function(s){t.deleteBtn(e)}}})])])}))])},[],!1,null,"8364fd04",null));k.options.__file="editTag.vue";var C=k.exports,y=s("UinD"),w={components:{NewTag:b,EditTag:C},props:{taskData:{type:Object,default:function(){return{}}},placement:String},data:function(){return{tagShow:!1,tagContent:0,tagInputChange:"",editTagList:[],particularsTagList:[],particularsTagListCopy:[],newTagTitle:"",newTagInput:"",bgColorProps:"",editTagId:"",popoverWidth:"220"}},watch:{tagInputChange:function(t){this.particularsTagList=this.particularsTagListCopy.filter(function(e){return e.name.indexOf(t)>-1})}},mounted:function(){},methods:{createTagFun:function(){this.newTagTitle="创建新标签",this.newTagInput="",this.tagContent=1,this.popoverWidth="330"},editBtn:function(t){this.editTagId=t.labelId,this.newTagTitle="编辑标签",this.tagContent=3,this.bgColorProps=t.color,this.newTagInput=t.name},managementTag:function(){this.popoverWidth="400",this.tagContent=2},tagBtn:function(t,e){var s=this,a=e.filter(function(e){return t.check?e.check&&e.labelId!=t.labelId:e.check||e.labelId==t.labelId});for(var i in t.check?Object(r.j)({taskId:this.taskData.taskId,labelId:a.map(function(t){return t.labelId}).join(",")}).then(function(e){var a=s.taskData.labelList;for(var i in a)if(t.labelId==a[i].labelId){a.splice(i,1);break}t.check=!1}):Object(r.j)({taskId:this.taskData.taskId,labelId:a.map(function(t){return t.labelId}).join(",")}).then(function(e){t.check=!0,t.labelName=t.name,s.taskData.labelList.push(t)}),e)e[i].labelId==t.labelId?document.getElementsByClassName("tag-list")[i].style.background="#F7F8FA":document.getElementsByClassName("tag-list")[i].style.background="#FFF"},changeColor:function(t){this.bgColorProps=t},tagClose:function(){this.tagShow=!1},tagCreateSubmit:function(t,e){var s=this,a=this;"创建新标签"==this.newTagTitle?Object(y.e)({name:t,color:e}).then(function(t){s.tagClose(),s.tagListFun(),s.$message.success("创建成功")}):Object(y.e)({name:t,labelId:this.editTagId,color:e}).then(function(n){var o=!0,c=!1,l=void 0;try{for(var r,d=i()(a.editTagList);!(o=(r=d.next()).done);o=!0){var u=r.value;u.labelId==a.editTagId&&(u.name=t,u.color=e)}}catch(t){c=!0,l=t}finally{try{!o&&d.return&&d.return()}finally{if(c)throw l}}s.tagContent=2})},tagCancel:function(){"创建新标签"==this.newTagTitle?(this.tagClose(),this.$message.info("已取消创建")):this.tagContent=2},back:function(){"创建新标签"==this.newTagTitle?(this.tagContent=0,this.popoverWidth="220"):"编辑标签"==this.newTagTitle&&3==this.tagContent?this.tagContent=2:2==this.tagContent&&(this.tagContent=0,this.popoverWidth="220")},deleteBtn:function(t){var e=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"is-particulars"}).then(function(){e.tagShow=!0,e.managementTag(),Object(y.a)({labelId:t.labelId}).then(function(s){for(var a in e.editTagList)e.editTagList[a].labelId==t.labelId&&e.editTagList.splice(a,1);e.$message({type:"success",message:"删除成功!"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"}),e.tagShow=!0,e.managementTag()})},tagListFun:function(){var t=this;Object(y.c)().then(function(e){var s=!0,a=!1,n=void 0;try{for(var o,c=i()(e.data);!(s=(o=c.next()).done);s=!0){var l=o.value;if(t.taskData.labelList){var r=!0,d=!1,u=void 0;try{for(var m,h=i()(t.taskData.labelList);!(r=(m=h.next()).done);r=!0){if(m.value.labelId==l.labelId){l.check=!0;break}l.check=!1}}catch(t){d=!0,u=t}finally{try{!r&&h.return&&h.return()}finally{if(d)throw u}}}}}catch(t){a=!0,n=t}finally{try{!s&&c.return&&c.return()}finally{if(a)throw n}}t.editTagList=e.data,t.particularsTagList=e.data,t.particularsTagListCopy=e.data})},referenceFun:function(){this.tagContent=0,this.editTagList&&!this.editTagList.length&&this.tagListFun()}}},x=(s("20cK"),Object(v.a)(w,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"edit-index"},[s("el-popover",{attrs:{placement:t.placement,width:t.popoverWidth,trigger:"click"},model:{value:t.tagShow,callback:function(e){t.tagShow=e},expression:"tagShow"}},[0==t.tagContent?s("div",{staticClass:"tag-popover-box"},[s("div",{staticClass:"tag-top"},[s("span",[t._v("选择标签")]),t._v(" "),s("span",{staticClass:"el-icon-close rt cursor-pointer",on:{click:function(e){t.tagShow=!1}}})]),t._v(" "),s("el-input",{attrs:{placeholder:"搜索标签","prefix-icon":"el-icon-search",size:"small"},model:{value:t.tagInputChange,callback:function(e){t.tagInputChange=e},expression:"tagInputChange"}}),t._v(" "),s("div",{staticClass:"tag-content"},t._l(t.particularsTagList,function(e,a){return s("div",{key:a,staticClass:"tag-list",on:{click:function(s){t.tagBtn(e,t.particularsTagList)}}},[s("i",{staticClass:"wukong wukong-black-label",style:{color:e.color}}),t._v(" "),s("span",{staticClass:"item-label"},[t._v(t._s(e.name))]),t._v(" "),e.check?s("span",{staticClass:"el-icon-check rt"}):t._e()])})),t._v(" "),s("div",{staticClass:"tag-footer"},[s("p",{staticClass:"footer-row cursor-pointer",on:{click:t.createTagFun}},[s("span",{staticClass:"el-icon-plus"}),t._v(" "),s("span",[t._v("创建新标签")])]),t._v(" "),s("p",{staticClass:"footer-row cursor-pointer",on:{click:t.managementTag}},[s("span",{staticClass:"el-icon-setting"}),t._v(" "),s("span",[t._v("标签管理")])])])],1):1==t.tagContent?s("new-tag",{attrs:{"new-tag-title":t.newTagTitle,"new-tag-input":t.newTagInput,"bg-color-props":t.bgColorProps},on:{changeColor:t.changeColor,close:t.tagClose,tagCreateSubmit:t.tagCreateSubmit,tagCancel:t.tagCancel,back:t.back}}):2==t.tagContent?s("editTag",{attrs:{"edit-tag-list":t.editTagList},on:{back:t.back,close:t.tagClose,editBtn:t.editBtn,deleteBtn:t.deleteBtn}}):3==t.tagContent?s("new-tag",{attrs:{"new-tag-title":t.newTagTitle,"new-tag-input":t.newTagInput,"bg-color-props":t.bgColorProps},on:{changeColor:t.changeColor,close:t.tagClose,tagCreateSubmit:t.tagCreateSubmit,tagCancel:t.tagCancel,back:t.back}}):t._e(),t._v(" "),s("span",{attrs:{slot:"reference"},on:{click:t.referenceFun},slot:"reference"},[t._t("editIndex")],2)],1)],1)},[],!1,null,"34720cec",null));x.options.__file="tagIndex.vue";var I=x.exports,_=s("gDS+"),D=s.n(_),T=s("0hym"),A={components:{XhUser:T.a},props:{taskData:{type:Object,default:function(){return{}}},text:String,time:[String,Number],subData:Object,subTaskCom:{type:String,default:""},taskId:[Number,String],checkboxData:{type:Boolean,default:!1}},data:function(){return{subtasksDate:"",xhUserData:[],subtaskChange:!1,num:0,subtasksTextarea:"",isNum:0,showUserPopover:!1}},computed:{ownerListRequest:function(){return d.n},workId:function(){return this.taskData.workId}},watch:{},created:function(){"edit"==this.subTaskCom&&(this.subtasksTextarea=this.text?this.text:"",this.subtasksDate=this.time,"{}"!==D()(this.subData)?this.subData.mainUser&&(this.subtaskChange=!0,this.xhUserData=[this.subData.mainUser]):(this.xhUserData=[],this.subtaskChange=!1))},methods:{subtasksSubmit:function(t){var e=this;this.subtasksTextarea=this.subtasksTextarea.split(/[\n]/).join(""),this.subtasksTextarea&&0==this.num?(this.num=1,"new"==this.subTaskCom?(this.$emit("on-handle",{type:"add",result:"success"}),Object(r.j)({pid:this.taskData.taskId,name:this.subtasksTextarea,stopTime:this.subtasksDate,mainUserId:0!=this.xhUserData.length?this.xhUserData[0].userId:""}).then(function(t){e.taskData.childTask.push({name:e.subtasksTextarea,stopTime:e.subtasksDate,taskId:t.data.taskId,mainUser:e.xhUserData.length>0?e.xhUserData[0]:null}),e.$message.success("子任务创建成功"),e.subtasksTextarea="",e.subtasksDate="",e.subtaskChange=!1,e.num=0}).catch(function(){e.$emit("on-handle",{type:"add",result:"error"}),e.$message.error("子任务创建失败"),e.num=0})):"edit"==this.subTaskCom&&(1==this.isNum||this.text!=this.subtasksTextarea||this.subtasksDate!=this.time?(this.$emit("on-handle",{type:"edit",result:"success"}),Object(r.j)({taskId:this.taskId,stopTime:this.subtasksDate,mainUserId:this.xhUserData.length>0?this.xhUserData[0].id:"",name:this.subtasksTextarea}).then(function(t){var s=e.taskData.childTask;for(var a in s)if(s[a].taskId==e.taskId){var i=s[a];i.name=e.subtasksTextarea,i.stopTime=e.subtasksDate,i.mainUser=e.xhUserData.length>0?e.xhUserData[0]:null,s.splice(a,1,i);break}e.num=0,e.$message.success("子任务编辑成功")}).catch(function(){e.$emit("on-handle",{type:"edit",result:"error"}),e.$message.error("子任务编辑失败"),e.num=0})):this.$emit("on-handle",{type:"cancel"}))):this.$emit("on-handle",{type:"cancel"})},xhUserCheckout:function(t){0!=t.data.length?(this.subtaskChange=!0,0!=this.xhUserData.length?(this.$set(this.xhUserData[0],"img",t.data[0].img),this.$set(this.xhUserData[0],"realname",t.data[0].realname)):this.xhUserData=t.data,this.isNum=1):(this.isNum=0,this.subtaskChange=!1),this.showUserPopover=!1},subtasksDateFun:function(){this.$refs.subtasksDate.change()}}},R=(s("lQJL"),Object(v.a)(A,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"task-sub"},[s("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:t.subtasksSubmit,expression:"subtasksSubmit"}],staticClass:"subtasks-content"},[s("div",{staticClass:"checkbox-box subtasks-box"},[s("el-checkbox",{attrs:{disabled:""},model:{value:t.checkboxData,callback:function(e){t.checkboxData=e},expression:"checkboxData"}})],1),t._v(" "),s("div",{staticClass:"subtasks-content-box"},[s("el-input",{attrs:{maxlength:50,type:"textarea",autosize:"",placeholder:"请输入内容"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.subtasksSubmit(e):null}},model:{value:t.subtasksTextarea,callback:function(e){t.subtasksTextarea=e},expression:"subtasksTextarea"}})],1),t._v(" "),s("flexbox",{staticClass:"subtasks-content-png"},[s("div",{staticClass:"time"},[s("el-date-picker",{ref:"subtasksDate",style:{width:t.subtasksDate?"54px":"28px"},attrs:{type:"date",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.subtasksDate,callback:function(e){t.subtasksDate=e},expression:"subtasksDate"}}),t._v(" "),t.subtasksDate?s("span",{staticClass:"bg-color"},[t._v(t._s(t._f("moment")(t.subtasksDate,"MM-DD")))]):s("i",{staticClass:"wukong wukong-time-task",on:{click:t.subtasksDateFun}})],1),t._v(" "),s("el-popover",{attrs:{placement:"bottom-end",width:"280",trigger:"click"},model:{value:t.showUserPopover,callback:function(e){t.showUserPopover=e},expression:"showUserPopover"}},[s("xh-user",{ref:"xhuser",attrs:{"info-request":t.ownerListRequest,"info-params":{workId:t.workId},"selected-data":t.xhUserData,radio:""},on:{changeCheckout:t.xhUserCheckout}}),t._v(" "),s("div",{staticClass:"select-box",attrs:{slot:"reference"},slot:"reference"},[t.subtaskChange?t._l(t.xhUserData,function(e,a){return s("span",{key:a},[s("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[s("div",{attrs:{slot:"content"},slot:"content"},[s("span",{on:{click:function(e){t.showUserPopover=!0}}},[t._v(t._s(e.realname))])]),t._v(" "),s("div",{directives:[{name:"photo",rawName:"v-photo",value:e,expression:"item"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(e.img),expression:"$options.filters.filterUserLazyImg(item.img)",arg:"background-image"}],key:e.img||e.userId,staticClass:"div-photo"})])],1)}):s("i",{staticClass:"wukong wukong-user"})],2)],1)],1)],1)])},[],!1,null,"866fdac0",null));R.options.__file="subTask.vue";var L=R.exports,E=s("S3Kq"),j=s("1RnH"),M=s("O1Uw"),N=s("uMjE"),S=s("L2JU"),U=s("7Qib"),z={components:{membersDep:h.a,emoji:E.a,relatedBusiness:j.a,XhUser:T.a,TagIndex:I,CRMFullScreenDetail:N.default,SubTask:L,FileCell:M.a},props:{id:[String,Number],detailIndex:Number,detailSection:Number,appendToBody:{type:Boolean,default:!1}},data:function(){return{zIndex:Object(U.h)(),commentsActivities:!0,commentsTextarea:"",childCommentsTextarea:"",replyChildComment:null,replyChildIndex:-1,contentLoading:!1,commentsPopover:!1,childCommentsPopover:!1,priorityVisible:!1,particularsList:[{id:3,label:"高",color:"#ED6363"},{id:2,label:"中",color:"#FF9668"},{id:1,label:"低",color:"#8bb5f0"},{id:0,label:"无",color:"#ccc"}],addSubtasks:!0,nameVinput:!1,taskDataName:"",addDescriptionShow:!1,addDescriptionTextarea:"",subTaskProgress:0,blurIndex:0,addComments:!1,allData:{},isComment:!0,commentsLoading:!1,relatedID:"",relatedCRMType:"",showRelatedDetail:!1,subTaskID:null,loading:!1,taskData:null,activityList:[],fileList:[],replyList:[]}},computed:o()({},Object(S.b)(["userInfo"]),{ownerListRequest:function(){return d.n},workId:function(){return this.taskData.workId},labelList:function(){return this.taskData&&this.taskData.labelList||[]}}),watch:{id:function(t){this.initInfo(),this.getDetail(),this.getCommentList(),this.getActivityList()},labelList:function(t){this.$emit("on-handle",{type:"change-label",value:t,index:this.detailIndex,section:this.detailSection})}},mounted:function(){this.appendToBody&&document.body.appendChild(this.$el),this.id&&(this.getDetail(),this.getCommentList(),this.getActivityList())},beforeDestroy:function(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)},methods:{initInfo:function(){this.taskData=null,this.subTaskProgress=0,this.allData={business:[],contacts:[],contract:[],customer:[]},this.taskData=null,this.activityList=[],this.fileList=[]},getDetail:function(){var t=this;this.loading=!0,Object(r.g)({taskId:this.id}).then(function(e){var s=e.data;if(s.checked=5==s.status,s.childTask){var a=!0,n=!1,o=void 0;try{for(var c,l=i()(s.childTask);!(a=(c=l.next()).done);a=!0){var r=c.value;5==r.status?(r.checked=!0,t.subTaskProgress++):r.checked=!1}}catch(t){n=!0,o=t}finally{try{!a&&l.return&&l.return()}finally{if(n)throw o}}}t.fileList=e.data.file,t.allData={business:s.businessList||[],contacts:s.contactsList||[],contract:s.contractList||[],customer:s.customerList||[]},t.taskData=s,t.loading=!1}).catch(function(){t.loading=!1,t.closeBtn()})},getActivityList:function(){var t=this;Object(r.h)({taskId:this.id}).then(function(e){t.activityList=e.data}).catch(function(){})},getCommentList:function(){var t=this;Object(r.a)({typeId:this.id,type:1}).then(function(e){t.replyList=e.data}).catch(function(){})},titleCheckbox:function(t){var e=this;this.taskData.checked=t,Object(r.j)({taskId:this.id,status:this.taskData.checked?5:1}).then(function(s){e.$emit("on-handle",{type:"title-check",value:t,index:e.detailIndex,section:e.detailSection}),e.$store.dispatch("GetOAMessageNum","task")}).catch(function(){e.$emit("on-handle",{type:"title-check",value:!e.taskData.checked,index:e.detailIndex,section:e.detailSection}),e.taskData.checked=!e.taskData.checked})},closeBtn:function(){this.$emit("close")},footerTitle:function(t){switch(t){case 0:this.commentsActivities=!0,this.isComment=!0;break;case 1:this.commentsActivities=!1,this.isComment=!1}},priorityBtn:function(t,e){var s=this;this.taskData.priority=t.id,Object(r.j)({taskId:this.id,priority:t.id}).then(function(e){s.$emit("on-handle",{type:"change-priority",value:t,index:s.detailIndex,section:s.detailSection}),s.priorityVisible=!1}).catch(function(){s.$message.error("编辑失败"),s.taskData.priority=e})},moreDelete:function(){var t=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"is-particulars"}).then(function(){Object(r.e)({taskId:t.id}).then(function(e){t.$message.success("删除成功"),t.$emit("on-handle",{type:"delete",index:t.detailIndex,section:t.detailSection}),t.$emit("close")}).catch(function(){})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},moreArchive:function(){var t=this;this.$confirm("此操作将归档该任务, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"is-particulars"}).then(function(){Object(r.d)({taskId:t.id}).then(function(e){t.$message.success("操作成功"),t.$emit("on-handle",{type:"delete",index:t.detailIndex,section:t.detailSection}),t.$emit("close")}).catch(function(){})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},httpRequest:function(t){var e=this;Object(u.d)({file:t.file,batchId:this.taskData.batchId}).then(function(t){t.filePath=t.url,e.fileList.push(t),e.$message.success("上传成功")}).catch(function(){})},accessoryDeleteFun:function(t,e){this.fileList.splice(t,1)},addSubtasksBtn:function(){this.addSubtasks=!this.addSubtasks},subtasksCheckbox:function(t,e){var s=this;e?(this.$set(t,"checked",!0),this.subTaskProgress++):(this.$set(t,"checked",!1),this.subTaskProgress--),this.$emit("on-handle",{type:"change-sub-task",value:{subdonecount:this.subTaskProgress,allcount:this.taskData.childTask.length},index:this.detailIndex,section:this.detailSection}),Object(r.j)({taskId:t.taskId,status:e?5:1}).then(function(t){}).catch(function(){s.$message.error("子任务标记失败"),e?(s.$set(t,"checked",!1),s.subTaskProgress--):(s.$set(t,"checked",!0),s.subTaskProgress++),s.$emit("on-handle",{type:"change-sub-task",value:{subdonecount:s.subTaskProgress,allcount:s.taskData.childTask.length},index:s.detailIndex,section:s.detailSection})})},editOwnerList:function(t,e){var s=this;Object(r.j)({taskId:this.id,ownerUserId:t.map(function(t){return t.userId}).join(",")}).then(function(e){s.taskData.ownerUserList=t}).catch(function(){})},deleteOwnerList:function(t,e){var s=this;Object(r.j)({taskId:this.id,ownerUserId:this.taskData.ownerUserList.filter(function(e){return e.userId!=t.userId}).map(function(t){return t.userId}).join(",")}).then(function(t){s.taskData.ownerUserList.splice(e,1)}).catch(function(){})},editMainUser:function(t){var e=this;Object(r.j)({taskId:this.id,mainUserId:t?t.data[0].userId:""}).then(function(s){t?e.$set(e.taskData,"mainUser",t.data[0]):e.$set(e.taskData,"mainUser",null),e.$emit("on-handle",{type:"change-main-user",value:t?t.data[0]:null,index:e.detailIndex,section:e.detailSection})}).catch(function(){})},nameVShow:function(t){var e=this;Object(r.j)({name:t,taskId:this.id}).then(function(s){e.nameVinput=!1,e.$emit("on-handle",{type:"change-name",value:t,index:e.detailIndex,section:e.detailSection}),e.taskData.name=t}).catch(function(){})},endTimeChange:function(t){var e=this;Object(r.j)({stopTime:t,taskId:this.id}).then(function(s){e.$emit("on-handle",{type:"change-stop-time",value:t,index:e.detailIndex,section:e.detailSection})}).catch(function(){})},addDescriptionSubmit:function(){var t=this;Object(r.j)({taskId:this.id,description:this.addDescriptionTextarea}).then(function(e){t.addDescriptionShow=!1,t.$set(t.taskData,"description",t.addDescriptionTextarea)}).catch(function(){})},selectEmoji:function(t){var e=this.commentsTextarea.split("");e.splice(this.blurIndex,0,t),this.commentsTextarea=e.join(""),this.commentsPopover=!1},selectEmojiChild:function(t){var e=this.childCommentsTextarea.split("");e.splice(this.blurIndex,0,t),this.childCommentsTextarea=e.join(""),this.childCommentsPopover=!1},addCommentsClick:function(){var t=this;this.addComments=!0,this.$nextTick(function(){t.$refs.commentsTextareaRef.focus()})},commentsSub:function(){var t=this;this.commentsTextarea&&(this.commentsLoading=!0,Object(r.m)({typeId:this.id,type:1,content:l()(this.commentsTextarea)}).then(function(e){e.data.childCommentList=[],e.data.show=!1,e.data.user=t.userInfo,t.replyList.push(e.data),t.commentsTextarea="",t.$emit("on-handle",{type:"change-comments",value:"add",index:t.detailIndex,section:t.detailSection}),t.commentsLoading=!1}).catch(function(){t.commentsLoading=!1}))},childCommentSubmit:function(){var t=this;if(this.replyChildComment&&this.childCommentsTextarea){var e=-1==this.replyChildIndex?this.replyChildComment:this.replyChildComment.childCommentList[this.replyChildIndex];Object(r.m)({pid:e.userId,typeId:e.typeId,mainId:0==e.mainId?e.commentId:e.mainId,type:1,content:l()(this.childCommentsTextarea)}).then(function(s){t.childCommentsPopover=!1,s.data.user=t.userInfo,s.data.replyUser=e.user,t.replyChildComment.childCommentList.push(s.data),t.replyChildComment.show=!1,t.replyChildComment=null,t.childCommentsTextarea="",t.$emit("on-handle",{type:"change-comments",value:"add",index:t.detailIndex,section:t.detailSection})}).catch(function(){})}},discussDelete:function(t,e,s){var a=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"is-particulars"}).then(function(){Object(r.l)({commentId:t.commentId}).then(function(t){e.splice(s,1),a.$emit("on-handle",{type:"change-comments",value:"delete",index:a.detailIndex,section:a.detailSection})}).catch(function(){})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},discussBtn:function(t,e){var s=this;t.show?(this.$set(t,"show",!1),this.replyChildComment=null):(this.$set(t,"show",!0),this.replyChildComment=t,this.replyChildIndex=e,this.$nextTick(function(){s.$refs.childCommentsTextareaRef[0].focus()}))},blurFun:function(t){this.blurIndex=t.target.selectionEnd},checkInfos:function(t){var e=this;Object(r.b)({taskId:this.id,customerIds:t.customerIds&&t.customerIds.length?","+t.customerIds.join(",")+",":"",contactsIds:t.contactsIds&&t.contactsIds.length?","+t.contactsIds.join(",")+",":"",businessIds:t.businessIds&&t.businessIds.length?","+t.businessIds.join(",")+",":"",contractIds:t.contractIds&&t.contractIds.length?","+t.contractIds.join(",")+",":""}).then(function(t){e.$message.success("关联成功")}).catch(function(){})},commentsSubmit:function(t){this.addComments=!1},checkRelatedDetail:function(t,e){this.relatedID=e.key,this.relatedCRMType=t,this.showRelatedDetail=!0},deleteSubTask:function(t){var e=this;this.$confirm("此操作将删除该任务, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"is-particulars"}).then(function(){Object(r.e)({taskId:t.taskId}).then(function(s){var a=e.taskData.childTask;for(var i in a)if(a[i].taskId==t.taskId){a.splice(i,1);break}t.checked&&(e.subTaskProgress--,e.$emit("on-handle",{type:"change-sub-task",value:{subdonecount:e.subTaskProgress,allcount:e.taskData.childTask.length},index:e.detailIndex,section:e.detailSection})),e.$message.success("子任务删除成功")}).catch(function(){e.$message.error("子任务删除失败")})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},editSubTask:function(t){this.subTaskID=t.taskId;var e=this.taskData.childTask;for(var s in e)e[s].taskId==t.taskId?this.$set(e[s],"showEdit",!0):this.$set(e[s],"showEdit",!1)},handleSubTasksBlock:function(t,e){"edit"==t.type?this.$set(e,"showEdit",!1):"add"==t.type?(this.addSubtasks=!0,"success"==t.result?this.$emit("on-handle",{type:"change-sub-task",value:{subdonecount:this.subTaskProgress,allcount:this.taskData.childTask.length+1},index:this.detailIndex,section:this.detailSection}):this.$emit("on-handle",{type:"change-sub-task",value:{subdonecount:this.subTaskProgress,allcount:this.taskData.childTask.length-1},index:this.detailIndex,section:this.detailSection})):"cancel"==t.type&&(e?this.$set(e,"showEdit",!1):this.addSubtasks=!0)},deleteTimeTop:function(){var t=this;Object(r.j)({taskId:this.id,stopTime:""}).then(function(e){t.$set(t.taskData,"stopTime","")}).catch(function(){})},activateTask:function(){var t=this;this.loading=!0,Object(r.i)({taskId:this.taskData.taskId}).then(function(e){t.loading=!1,t.$emit("on-handle",{type:"activate-task",index:t.detailIndex,section:t.detailSection}),t.closeBtn()}).catch(function(){t.loading=!1})},recoverTask:function(){var t=this;this.loading=!0,Object(m.c)({taskId:this.taskData.taskId}).then(function(e){t.loading=!1,t.$message.success("恢复成功"),t.$emit("on-handle",{type:"recover-task",index:t.detailIndex,section:t.detailSection}),t.closeBtn()}).catch(function(){t.loading=!1})},thoroughDeleteTask:function(){var t=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.loading=!0,Object(m.a)({taskId:t.taskData.taskId}).then(function(e){t.loading=!1,t.$emit("on-handle",{type:"thorough-delete-task",index:t.detailIndex,section:t.detailSection}),t.closeBtn()}).catch(function(){t.loading=!1})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})}}},O=(s("LC2R"),Object(v.a)(z,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"slide-fade"}},[a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"particulars-common",style:{"z-index":t.zIndex}},[t.taskData?a("div",{staticClass:"clear-fix",attrs:{slot:"header"},slot:"header"},[t.taskData&&t.taskData.workName?a("div",{staticClass:"work-name"},[t._v(t._s(t.taskData.workName))]):t._e(),t._v(" "),a("div",{staticClass:"img-box-grop"},[a("div",[a("el-popover",{attrs:{placement:"bottom-start",width:"200",trigger:"click"},model:{value:t.priorityVisible,callback:function(e){t.priorityVisible=e},expression:"priorityVisible"}},[a("div",{staticClass:"particulars-priority-box"},t._l(t.particularsList,function(e,s){return a("p",{key:s,on:{click:function(s){t.priorityBtn(e,t.taskData.priority)}}},[a("span",{style:{"border-color":e.color,background:e.id==t.taskData.priority?e.color:"transparent",color:e.id==t.taskData.priority?"#fff":e.color}},[t._v(t._s(e.label))])])})),t._v(" "),a("span",{attrs:{slot:"reference"},slot:"reference"},[a("i",{staticClass:"wukong wukong-lightning"}),t._v(" "),a("span",[t._v("优先级")])])])],1),t._v(" "),a("div",[a("tag-index",{attrs:{placement:"bottom","task-data":t.taskData}},[a("div",{attrs:{slot:"editIndex"},slot:"editIndex"},[a("i",{staticClass:"wukong wukong-label"}),t._v(" "),a("span",[t._v("标签")])])])],1),t._v(" "),0==t.taskData.pid?a("div",{on:{click:t.addSubtasksBtn}},[a("i",{staticClass:"wukong wukong-sub-task"}),t._v(" "),a("span",[t._v("子任务")])]):t._e(),t._v(" "),a("div",[a("el-dropdown",[a("span",{staticClass:"el-dropdown-link"},[a("i",{staticClass:"wukong wukong-file"}),t._v(" "),a("span",[t._v("附件")])]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-upload",{staticClass:"upload-demo",attrs:{"http-request":t.httpRequest,action:"https://jsonplaceholder.typicode.com/posts/",multiple:"","list-type":"picture"}},[a("span",[t._v("本地上传")])])],1),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[a("el-upload",{staticClass:"upload-demo",attrs:{"http-request":t.httpRequest,action:"http://192.168.1.174:28080/minio/uploadFilec",multiple:"","list-type":"picture"}},[a("span",[t._v("本地上传")])])],1),t._v(" "),a("el-dropdown-item",[a("el-upload",{staticClass:"upload-demo",attrs:{"http-request":t.httpRequest,action:"https://jsonplaceholder.typicode.com/posts/",multiple:"","list-type":"picture"}},[a("span",[t._v("网盘上传")])])],1)],1)],1)],1),t._v(" "),1!=t.taskData.ishidden?a("div",[a("el-popover",{attrs:{placement:"bottom",width:"80",trigger:"click"}},[a("div",{staticClass:"more-btn-group"},[a("p",[t._v("设置任务提醒")]),t._v(" "),a("p",[t._v("设置重复提醒")]),t._v(" "),a("p",[t._v("设置前置任务")]),t._v(" "),a("p",[t._v("设置后置任务")]),t._v(" "),a("p",[t._v("共享任务")]),t._v(" "),a("p",[t._v("从网盘选取附件")]),t._v(" "),a("p",[t._v("移动任务")]),t._v(" "),a("p",[t._v("拷贝任务")]),t._v(" "),1!=t.taskData.isArchive&&1!=t.taskData.ishidden?a("p",{on:{click:t.moreArchive}},[t._v("归 档")]):t._e(),t._v(" "),1!=t.taskData.ishidden?a("p",{on:{click:t.moreDelete}},[t._v("删 除")]):t._e(),t._v(" "),a("p",[t._v("打印")])]),t._v(" "),a("span",{attrs:{slot:"reference"},slot:"reference"},[a("img",{attrs:{src:s("DcnZ")}})])])],1):t._e(),t._v(" "),a("div",{staticClass:"task-close-img"},[a("img",{attrs:{src:s("cjwK")},on:{click:t.closeBtn}})])])]):t._e(),t._v(" "),t.taskData?a("div",{staticClass:"body-content"},[1==t.taskData.isArchive&&1!=t.taskData.ishidden?a("div",{staticClass:"particulars-extraContent"},[a("span",{staticClass:"text"},[t._v("该任务已于 "+t._s(t.taskData.archiveTime)+" 被归档。")]),t._v(" "),a("el-button",{staticClass:"border-radius",attrs:{type:"primary",size:"mini"},on:{click:t.activateTask}},[t._v("激活")])],1):t._e(),t._v(" "),1==t.taskData.ishidden?a("div",{staticClass:"particulars-extraContent"},[a("span",{staticClass:"text"},[t._v("该任务已于 "+t._s(t.taskData.hiddenTime)+" 被放入回收站。")]),t._v(" "),a("el-button",{staticClass:"border-radius",attrs:{type:"primary",size:"mini"},on:{click:t.recoverTask}},[t._v("恢 复")]),t._v(" "),a("el-button",{attrs:{type:"text"},on:{click:t.thoroughDeleteTask}},[t._v("彻底删除")])],1):t._e(),t._v(" "),a("div",{staticClass:"card-content-box"},[a("div",{staticClass:"card-content"},[a("div",{staticClass:"card-content-row margin-bottom-15"},[a("el-checkbox",{on:{change:t.titleCheckbox},model:{value:t.taskData.checked,callback:function(e){t.$set(t.taskData,"checked",e)},expression:"taskData.checked"}}),t._v(" "),a("div",{staticClass:"priority-data-name"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.nameVinput,expression:"!nameVinput"}],staticClass:"title-text",style:{"text-decoration":t.taskData.checked?"line-through":"none"}},[t._v(t._s(t.taskData.name)+"\n                "),a("span",{staticClass:"el-icon-edit-outline",on:{click:function(e){t.nameVinput=!0,t.taskDataName=t.taskData.name}}})]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.nameVinput,expression:"nameVinput"}],staticClass:"show-input"},[a("el-input",{attrs:{maxlength:50,size:"medium"},model:{value:t.taskDataName,callback:function(e){t.taskDataName=e},expression:"taskDataName"}}),t._v(" "),a("div",{staticClass:"btn-box"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.nameVShow(t.taskDataName)}}},[t._v("保 存")]),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(e){t.nameVinput=!1}}},[t._v("取 消")])],1)],1)]),t._v(" "),a("div",{staticClass:"card-row-right"},[a("flexbox",{staticClass:"text-right"},[a("div",{staticClass:"color-label user-name-label"},[t._v(" 负责人： ")]),t._v(" "),t.taskData.mainUser?a("div",{staticClass:"bg-position"},[a("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("span",[t._v(t._s(t.taskData.mainUser.realname))])]),t._v(" "),a("div",{directives:[{name:"photo",rawName:"v-photo",value:t.taskData.mainUser,expression:"taskData.mainUser"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.taskData.mainUser.img),expression:"$options.filters.filterUserLazyImg(taskData.mainUser.img)",arg:"background-image"}],key:t.taskData.main_user_img,staticClass:"div-photo main-user-name"})]),t._v(" "),a("img",{staticClass:"el-icon-close",attrs:{src:s("cEue"),alt:""},on:{click:function(e){t.editMainUser("")}}})],1):[a("el-popover",{attrs:{placement:"bottom",width:"280",trigger:"click"}},[a("xh-user",{ref:"xhuser",attrs:{"info-request":t.ownerListRequest,"info-params":{workId:t.workId},radio:""},on:{changeCheckout:t.editMainUser}}),t._v(" "),a("i",{staticClass:"wukong wukong-addition-task",attrs:{slot:"reference"},slot:"reference"})],1)]],2)],1)],1),t._v(" "),t.taskData.labelList?a("div",{staticClass:"card-content-row  margin-bottom-25"},[a("div",{staticClass:"particulars-priority-copy"},[t._l(t.taskData.labelList,function(e,s){return a("span",{key:s,staticClass:"item-color",style:{background:e.color?e.color:"#ccc"}},[t._v("\n                  "+t._s(e.labelName)+"\n                ")])}),t._v(" "),a("div",{staticClass:"add-tag"},[a("tag-index",{attrs:{placement:"right","task-data":t.taskData}},[a("div",{attrs:{slot:"editIndex"},slot:"editIndex"},[a("span",{staticClass:"el-icon-plus"}),t._v(" "),a("span",{staticClass:"label"},[t._v("标签")])])])],1)],2),t._v(" "),a("div",{staticClass:"card-row-right"},[a("div",{staticClass:"text-right"},[a("span",{staticClass:"color-label"},[t._v("开始日期 - 截止日期 ")]),t._v(" "),a("div",{staticClass:"time-top"},[a("el-date-picker",{ref:"endTime",class:{"no-time-top":!t.taskData.stopTime},attrs:{clearable:!1,type:"date",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",placeholder:""},on:{change:t.endTimeChange},model:{value:t.taskData.stopTime,callback:function(e){t.$set(t.taskData,"stopTime",e)},expression:"taskData.stopTime"}}),t._v(" "),t.taskData.stopTime?a("img",{staticClass:"el-icon-close time-top-close",attrs:{src:s("cEue"),alt:""},on:{click:function(e){e.stopPropagation(),t.deleteTimeTop(t.taskData.stopTime)}}}):t._e()],1)])])]):t._e(),t._v(" "),a("div",{staticClass:"add-description"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.addDescriptionShow,expression:"!addDescriptionShow"}]},[t.taskData.description?a("div",{staticClass:"description-content",on:{click:function(e){t.addDescriptionShow=!0,t.addDescriptionTextarea=t.taskData.description}}},[t._v(t._s(t.taskData.description))]):a("div",{staticClass:"no-description"},[a("span",{staticClass:"color-label"},[t._v("暂无描述")]),t._v(" "),a("el-button",{attrs:{type:"text",icon:"el-icon-plus"},on:{click:function(e){t.addDescriptionShow=!0}}},[t._v("添加描述")])],1)]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.addDescriptionShow,expression:"addDescriptionShow"}]},[a("el-input",{attrs:{autosize:{minRows:2},type:"textarea",placeholder:"请输入内容"},model:{value:t.addDescriptionTextarea,callback:function(e){t.addDescriptionTextarea=e},expression:"addDescriptionTextarea"}}),t._v(" "),a("div",{staticClass:"btn-box"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.addDescriptionSubmit}},[t._v("保 存")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){t.addDescriptionShow=!1}}},[t._v("取 消")])],1)],1)]),t._v(" "),a("div",{staticClass:"card-content-row card-content-row-column"},[a("flexbox",[a("div",{staticClass:"color-label participant"},[a("i",{staticClass:"wukong wukong-user"}),t._v(" "),a("span",[t._v("参与人： ")])]),t._v(" "),t.taskData.ownerUserList?a("div",{staticClass:"participant-class"},t._l(t.taskData.ownerUserList,function(e,i){return a("span",{key:i,staticClass:"owner-list"},[a("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("span",[t._v(t._s(e.realname))])]),t._v(" "),a("div",{directives:[{name:"photo",rawName:"v-photo",value:e,expression:"item"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(e.img),expression:"$options.filters.filterUserLazyImg(item.img)",arg:"background-image"}],key:e.img,staticClass:"div-photo item-img"})]),t._v(" "),a("img",{staticClass:"el-icon-close",attrs:{src:s("cEue")},on:{click:function(s){t.deleteOwnerList(e,i)}}})],1)})):t._e(),t._v(" "),a("members-dep",{attrs:{"close-dep":!0,"content-block":!1,"user-checked-data":t.taskData.ownerUserList,"user-request":t.ownerListRequest,"user-params":{workId:t.workId}},on:{popoverSubmit:t.editOwnerList}},[a("i",{staticClass:"wukong wukong-addition-task",attrs:{slot:"membersDep"},slot:"membersDep"})])],1)],1),t._v(" "),a("div",{staticClass:"card-content-row card-content-row-column margin-bottom-30"},[a("span",{staticClass:"color-label participant"},[a("i",{staticClass:"wukong wukong-relevance"}),t._v(" "),a("span",[t._v("关联业务")])]),t._v(" "),a("related-business",{attrs:{"margin-left":"0","is-task":!0,"all-data":t.allData,"task-id":t.taskData.taskId},on:{checkRelatedDetail:t.checkRelatedDetail,checkInfos:t.checkInfos}})],1),t._v(" "),0==t.taskData.pid?a("div",{staticClass:"card-content-row card-content-row-column"},[a("div",{staticClass:"display-flex sub-task margin-bottom-7"},[a("span",{staticClass:"color-label participant"},[a("i",{staticClass:"wukong wukong-sub-task"}),t._v(" "),a("span",[t._v("子任务")])]),t._v(" "),0!=t.taskData.childTask.length?[a("span",{staticClass:"color-label sub-task-progress"},[t._v(" ("+t._s(t.subTaskProgress)+"/"+t._s(t.taskData.childTask.length)+") ")]),t._v(" "),a("el-progress",{attrs:{percentage:t.subTaskProgress/t.taskData.childTask.length*100,"stroke-width":10}})]:[a("span",{staticClass:"color-label sub-task-progress"},[t._v(" ("+t._s(t.subTaskProgress)+"/"+t._s(t.taskData.childTask.length)+") ")]),t._v(" "),a("el-progress",{attrs:{percentage:0}})]],2),t._v(" "),0!=t.taskData.childTask.length?t._l(t.taskData.childTask,function(e,s){return a("div",{key:s,staticClass:"card-related-matters subtasks-box"},[e.showEdit?a("sub-task",{attrs:{"sub-task-com":"edit",time:e.stopTime,"sub-data":e,text:e.name,"task-id":t.subTaskID,"checkbox-data":e.checked,"task-data":t.taskData},on:{"on-handle":function(s){t.handleSubTasksBlock(s,e)}}}):a("div",{staticClass:"show-edit"},[a("div",{staticStyle:{display:"inline-block"},on:{click:function(t){t.stopPropagation()}}},[a("el-checkbox",{on:{change:function(s){t.subtasksCheckbox(e,s)}},model:{value:e.checked,callback:function(s){t.$set(e,"checked",s)},expression:"item.checked"}})],1),t._v(" "),a("span",{staticClass:"item-name",style:{"text-decoration":e.checked?"line-through":"none"}},[t._v(t._s(e.name))]),t._v(" "),a("div",{staticClass:"edit-del-box"},[a("i",{staticClass:"wukong wukong-edit-task",on:{click:function(s){t.editSubTask(e)}}}),t._v(" "),a("i",{staticClass:"wukong wukong-delete-task",on:{click:function(s){t.deleteSubTask(e)}}})]),t._v(" "),a("div",{staticClass:"rt"},[a("flexbox",{staticClass:"rt-box"},[e.stopTime?a("div",{staticClass:"bg-color task-bg-color"},[t._v(t._s(t._f("moment")(e.stopTime,"MM-DD"))+" 截止")]):t._e(),t._v(" "),e.mainUser?a("div",{directives:[{name:"photo",rawName:"v-photo",value:e.mainUser,expression:"item.mainUser"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(e.mainUser.img),expression:"$options.filters.filterUserLazyImg(item.mainUser.img)",arg:"background-image"}],key:e.mainUser.img,staticClass:"div-photo"}):t._e()])],1)])],1)}):t._e(),t._v(" "),t.addSubtasks?a("div",{staticClass:"add-subtasks",on:{click:function(e){t.addSubtasks=!1}}},[a("span",{staticClass:"el-icon-plus"}),t._v(" "),a("span",[t._v("添加子任务")])]):a("sub-task",{attrs:{"sub-task-com":"new","task-data":t.taskData},on:{"on-handle":t.handleSubTasksBlock}})],2):t._e(),t._v(" "),0!=t.fileList.length?a("div",{staticClass:"card-content-row card-content-row-column"},[a("span",{staticClass:"color-label participant class-file"},[a("i",{staticClass:"wukong wukong-file"}),t._v(" "),a("span",[t._v("附件")])]),t._v(" "),a("div",{staticClass:"accessory-box"},t._l(t.fileList,function(e,s){return a("file-cell",{key:s,attrs:{data:e,"cell-index":s,"module-id":t.id,"show-delete":!0},on:{delete:t.accessoryDeleteFun}})}))]):t._e()])]),t._v(" "),a("div",{staticClass:"border"}),t._v(" "),a("div",{staticClass:"card-footers"},[a("div",{staticClass:"footer-title"},[a("span",{on:{click:function(e){t.footerTitle(0)}}},[t.isComment?a("i",{staticClass:"wukong wukong-comment-task",staticStyle:{color:"#3E84E9"}}):a("i",{staticClass:"wukong wukong-comment-task"}),t._v(" "),a("span",{staticClass:"cursor-pointer",style:{color:t.isComment?"#3E84E9":"#666"}},[t._v("评论")])]),t._v(" "),a("span",{staticClass:"title-border"}),t._v(" "),a("span",{on:{click:function(e){t.footerTitle(1)}}},[t.isComment?a("i",{staticClass:"wukong wukong-activity-task",staticStyle:{"font-size":"18px"}}):a("i",{staticClass:"wukong wukong-activity-task",staticStyle:{color:"#3E84E9","font-size":"18px"}}),t._v(" "),a("span",{staticClass:"cursor-pointer",style:{color:t.isComment?"#666":"#3E84E9"},on:{click:function(e){t.footerTitle(t.isComment)}}},[t._v("活动")])])]),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.commentsLoading,expression:"commentsLoading"}],staticClass:"footer-content-box"},[a("div",{staticClass:"footer-content"},[t.commentsActivities?a("div",{staticClass:"add-comments"},[a("div",{staticClass:"footer-img"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:t.userInfo,expression:"userInfo"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.userInfo.img),expression:"$options.filters.filterUserLazyImg(userInfo.img)",arg:"background-image"}],key:t.userInfo.img,staticClass:"div-photo"})]),t._v(" "),a("div",{staticClass:"comments-con"},[t.addComments?a("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:t.commentsSubmit,expression:"commentsSubmit"}],staticClass:"comments-box"},[a("el-input",{ref:"commentsTextareaRef",attrs:{rows:4,type:"textarea",placeholder:"添加评论"},on:{blur:t.blurFun},model:{value:t.commentsTextarea,callback:function(e){t.commentsTextarea=e},expression:"commentsTextarea"}}),t._v(" "),a("div",{staticClass:"btn-group"},[a("el-popover",{attrs:{placement:"top",width:"400",trigger:"click"},model:{value:t.commentsPopover,callback:function(e){t.commentsPopover=e},expression:"commentsPopover"}},[a("emoji",{on:{select:t.selectEmoji}}),t._v(" "),a("img",{staticClass:"smiling-img",attrs:{slot:"reference",src:s("woiz")},slot:"reference"})],1),t._v(" "),a("el-button",{staticClass:"rt",attrs:{type:"primary"},on:{click:t.commentsSub}},[t._v("发布")])],1)],1):a("div",{staticClass:"footer-bg",on:{click:t.addCommentsClick}},[t._v("添加评论")]),t._v(" "),t.replyList&&0!=t.replyList.length?a("div",{staticClass:"discuss"},t._l(t.replyList,function(e,i){return a("div",{key:i,staticClass:"discuss-list"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:e.user,expression:"discussItem.user"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(e.user.img),expression:"$options.filters.filterUserLazyImg(discussItem.user.img)",arg:"background-image"}],key:e.user.img,staticClass:"div-photo head-img header-circle"}),t._v(" "),a("span",{staticClass:"name"},[t._v(t._s(e.user.realname))]),t._v(" "),a("span",{staticClass:"time"},[t._v(t._s(e.createTime))]),t._v(" "),a("div",{staticClass:"rt"},[a("span",{on:{click:function(s){t.discussDelete(e,t.replyList,i)}}},[t._v("删除")]),t._v(" "),a("span",{on:{click:function(s){t.discussBtn(e,-1)}}},[t._v("回复")])]),t._v(" "),a("p",{staticClass:"reply-title"},[a("span",{domProps:{innerHTML:t._s(t.emoji(e.content))}})]),t._v(" "),e.childCommentList&&e.childCommentList.length>0?a("div",{staticClass:"children-reply"},t._l(e.childCommentList,function(s,i){return a("div",{key:i,staticClass:"discuss-list"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:s.user,expression:"childDiscussItem.user"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(s.user.img),expression:"$options.filters.filterUserLazyImg(childDiscussItem.user.img)",arg:"background-image"}],key:s.user.img,staticClass:"div-photo head-img header-circle"}),t._v(" "),a("span",{staticClass:"name"},[t._v(t._s(s.user.realname))]),t._v(" "),a("span",{staticClass:"time"},[t._v(t._s(s.createTime))]),t._v(" "),a("div",{staticClass:"rt"},[a("span",{on:{click:function(a){t.discussDelete(s,e.childCommentList,i)}}},[t._v("删除")]),t._v(" "),a("span",{on:{click:function(s){t.discussBtn(e,i)}}},[t._v("回复")])]),t._v(" "),a("p",{staticClass:"reply-title"},[[a("span",[t._v("回复")]),t._v(" "),s.replyUser?a("span",{staticClass:"reply"},[t._v("@"+t._s(s.replyUser.realname)+"：")]):t._e()],t._v(" "),a("span",{domProps:{innerHTML:t._s(t.emoji(s.content))}})],2)])})):t._e(),t._v(" "),e.show?a("div",{staticClass:"comment-box"},[a("el-input",{ref:"childCommentsTextareaRef",refInFor:!0,attrs:{rows:2,type:"textarea",placeholder:"请输入内容"},on:{blur:t.blurFun},model:{value:t.childCommentsTextarea,callback:function(e){t.childCommentsTextarea=e},expression:"childCommentsTextarea"}}),t._v(" "),a("div",{staticClass:"btn-group"},[a("el-popover",{attrs:{placement:"top",width:"400",trigger:"click"},model:{value:t.childCommentsPopover,callback:function(e){t.childCommentsPopover=e},expression:"childCommentsPopover"}},[a("emoji",{on:{select:t.selectEmojiChild}}),t._v(" "),a("img",{staticClass:"smiling-img",attrs:{slot:"reference",src:s("woiz")},slot:"reference"})],1),t._v(" "),a("div",{staticClass:"btn-box"},[a("el-button",{attrs:{loading:t.contentLoading,type:"primary"},on:{click:function(e){t.childCommentSubmit()}}},[t._v("回复")]),t._v(" "),a("el-button",{on:{click:function(t){e.show=!1}}},[t._v("取消")])],1)],1)],1):t._e()])})):t._e()])]):a("div",{staticClass:"activity-box"},[0!=t.activityList.length?t._l(t.activityList,function(e,s){return a("flexbox",{key:s,staticClass:"activity-list",attrs:{align:"stretch"}},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:e,expression:"item"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(e.img),expression:"$options.filters.filterUserLazyImg(item.img)",arg:"background-image"}],key:e.img,staticClass:"div-photo"}),t._v(" "),a("div",{staticClass:"activity-name"},[t._v(t._s(e.realname))]),t._v(" "),a("div",{staticClass:"activity-content"},[t._v(t._s(e.content))]),t._v(" "),a("div",{staticClass:"activity-time"},[t._v(t._s(e.createTime))])])}):t._e()],2)])])]),t._v(" "),t._t("default")],2):t._e(),t._v(" "),t.taskData&&t.taskData.createUser?a("div",{staticClass:"tip"},[a("span",[t._v(t._s(t.taskData.createUser.realname)+" 创建于 "+t._s(t.taskData.createTime))])]):t._e(),t._v(" "),a("c-r-m-full-screen-detail",{attrs:{visible:t.showRelatedDetail,"crm-type":t.relatedCRMType,id:t.relatedID},on:{"update:visible":function(e){t.showRelatedDetail=e}}})],1)],1)},[],!1,null,"11d24396",null));O.options.__file="particulars.vue";e.a=O.exports},flx0:function(t,e,s){},huB7:function(t,e,s){},i68b:function(t,e,s){"use strict";var a=s("QbLZ"),i=s.n(a),n=s("KzkL"),o=s("L2JU");e.a={data:function(){return{followTypes:[],followType:""}},computed:i()({},Object(o.b)(["oa"]),{showOAPermission:function(){return this.oa}}),created:function(){this.getFollowLogType()},methods:{getFollowLogType:function(){var t=this;this.loading=!0,Object(n.x)().then(function(e){t.loading=!1,t.followTypes=e.data.map(function(t){return{type:t,name:t}}),t.followType=e.data.length>0?e.data[0]:""}).catch(function(){t.loading=!1})}},deactivated:function(){}}},i91G:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU2RjI0NjM0RTA5QjExRTg4QTE5QjM2OEE1QUE5MUZBIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU2RjI0NjM1RTA5QjExRTg4QTE5QjM2OEE1QUE5MUZBIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTZGMjQ2MzJFMDlCMTFFODhBMTlCMzY4QTVBQTkxRkEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTZGMjQ2MzNFMDlCMTFFODhBMTlCMzY4QTVBQTkxRkEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4H2LzoAAAAnklEQVR42mI8c+YMA7WAsbExAxMDlQGygSuA+B8Q/8eD/0HV4QQsSOwwNAtwAZChEcS4kJFIXzES62WqhyFdDESOqH1ocjuwRRQLAQPxRZQHEvsvLKKYKIkAbD5FNvA/kZr/ExuGq5HC6wiauo1I4bWa2IQdDsXYgP+gTTZUN5DYiPpHbDqERRQjAUtXE2sgvojCnnD///8/uCMFIMAAVWsql9WKpTgAAAAASUVORK5CYII="},kblT:function(t,e,s){"use strict";var a=s("6vqz");s.n(a).a},lDiL:function(t,e,s){"use strict";s.r(e);var a=s("fCst"),i=s("t3Un");var n=s("sl8O"),o={components:{particulars:a.a},data:function(){return{loading:!1,tableHeight:document.documentElement.clientHeight-205,list:[],currentPage:1,pageSize:15,pageSizes:[15,30,45,60],total:0}},created:function(){var t=this;window.onresize=function(){t.tableHeight=document.documentElement.clientHeight-205},this.getList()},methods:{handleSizeChange:function(t){this.pageSize=t,this.getList()},handleCurrentChange:function(t){this.currentPage=t,this.getList()},getList:function(){var t=this;this.loading=!0,function(t){return Object(i.a)({url:"work/queryArchiveWorkList",method:"post",data:t})}({page:this.currentPage,limit:this.pageSize}).then(function(e){t.list=e.data.list,t.loading=!1}).catch(function(){t.loading=!1})},recoverProject:function(t,e){var s=this;this.$confirm("确定恢复?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.loading=!0,Object(n.p)({workId:t.workId,status:1}).then(function(a){s.list.splice(e,1),s.$message.success("恢复成功"),s.$bus.$emit("recover-project",t.name,t.workId),s.loading=!1}).catch(function(){s.loading=!1})}).catch(function(){s.$message({type:"info",message:"已取消"})})}}},c=(s("WLv5"),s("KHd+")),l=Object(c.a)(o,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"archive-project"},[s("div",{staticClass:"header"},[t._v("\n    归档项目统计\n  ")]),t._v(" "),s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"content-body"},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"n-table--border",staticStyle:{width:"100%"},attrs:{id:"crm-table",data:t.list,height:t.tableHeight,stripe:"","highlight-current-row":""}},[s("el-table-column",{attrs:{resizable:!1,prop:"businessCheck",label:"",width:"38"},scopedSlots:t._u([{key:"header",fn:function(t){return[s("i",{staticClass:"wukong wukong-subproject",staticStyle:{color:"#999"}})]}},{key:"default",fn:function(t){return[s("i",{staticClass:"wukong wukong-subproject",style:{color:t.row.color}})]}}])}),t._v(" "),s("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"name",label:"项目名称"}}),t._v(" "),s("el-table-column",{attrs:{"show-overflow-tooltip":"",width:"200",prop:"archiveTime",label:"归档时间"}}),t._v(" "),s("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{type:"text"},nativeOn:{click:function(s){t.recoverProject(e.row,e.$index)}}},[t._v("恢复项目")])]}}])})],1),t._v(" "),s("div",{staticClass:"p-contianer"},[s("el-pagination",{staticClass:"p-bar",attrs:{"current-page":t.currentPage,"page-sizes":t.pageSizes,"page-size":t.pageSize,total:t.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:pageSize":function(e){t.pageSize=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)])},[],!1,null,"ec8d428a",null);l.options.__file="index.vue";e.default=l.exports},lQJL:function(t,e,s){"use strict";var a=s("pO1x");s.n(a).a},pO1x:function(t,e,s){},rl4O:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjUzM0EzN0E0RTA5QjExRTg4MTZEOEM2ODYxNjE5QjM3IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjUzM0EzN0E1RTA5QjExRTg4MTZEOEM2ODYxNjE5QjM3Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTMzQTM3QTJFMDlCMTFFODgxNkQ4QzY4NjE2MTlCMzciIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTMzQTM3QTNFMDlCMTFFODgxNkQ4QzY4NjE2MTlCMzciLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7neeY0AAABL0lEQVR42syUv0tCURSA1Vzam5ya+h8ag5DG3GpqqsAiwVFoECJc+jGpCFZrLTpFUjQ7PPwjClxyiCY3+y6cB5fLud0rOXjhG965j++de865L5skSWaRK5dZ8JpHmIUG/MAA1v4jNLIWVKAO6/CmSWOFO3AAJbiCLVjVpLHCV9iAF3ke+6S5wDFr8Az78Ons29LHkNDImnAO3/AAZeU9I+3AZhrI/9EAU7Nd6egIbuEJJk5tL2RPzVCTpfGZ0qieZF/TMvTJzmT+TqzsbFnZ/pidYUORHcKNzF87JHMzPJXUB1ZsBY6gGyNzhUM4lhEYS6ztqZkqc4+8B1N4h4LSgH5I5gq/YFuRprL7kEwbm4kjrYrsLkbmuymp9AMu4VpGZhZz6fOeuJEWl+KP/SvAAHR5UyjSji44AAAAAElFTkSuQmCC"},uMjE:function(t,e,s){"use strict";s.r(e);var a=s("7Qib"),i=s("mqlf"),n=s("ppJE"),o=s("PS1M"),c=s("n1dw"),l=s("xfX+"),r=s("8gwX"),d=s("K6D0"),u=s("7z+D"),m={name:"CRMFullScreenDetail",components:{ClueDetail:i.a,CustomerDetail:n.a,ContactsDetail:o.a,BusinessDetail:c.a,ContractDetail:l.a,ProductDetail:r.a,MoneyDetail:d.a,ExamineDetail:u.a},props:{id:[String,Number],crmType:{type:String,default:""},visible:{type:Boolean,default:!1}},data:function(){return{showDetail:!1}},computed:{tabName:function(){return"leads"==this.crmType?"clue-detail":"customer"==this.crmType?"customer-detail":"contacts"==this.crmType?"contacts-detail":"business"==this.crmType?"business-detail":"contract"==this.crmType?"contract-detail":"product"==this.crmType?"product-detail":"receivables"==this.crmType?"money-detail":"examine"==this.crmType?"examine-detail":""}},watch:{visible:function(t){this.showDetail=t,t&&(document.body.appendChild(this.$el),this.$el.addEventListener("click",this.handleDocumentClick,!1),this.$el.style.zIndex=Object(a.h)())},showDetail:function(t){var e=this;t||setTimeout(function(){e.$emit("update:visible",!1)},350)}},mounted:function(){this.visible&&(document.body.appendChild(this.$el),this.$el.addEventListener("click",this.handleDocumentClick,!1),this.$el.style.zIndex=Object(a.h)())},beforeDestroy:function(){this.$el&&this.$el.parentNode&&(this.$el.parentNode.removeChild(this.$el),this.$el.removeEventListener("click",this.handleDocumentClick,!1))},methods:{hiddenView:function(){this.showDetail=!1},handleDocumentClick:function(t){t.stopPropagation(),this.$el==t.target&&(this.showDetail=!1)},detailHandle:function(t){"alloc"!==t.type&&"get"!==t.type&&"transfer"!==t.type&&"transform"!==t.type&&"delete"!==t.type&&"put_seas"!==t.type||(this.showDetail=!1),this.$emit("handle",t)}}},h=(s("UZZ0"),s("KHd+")),p=Object(h.a)(m,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"full-container"},[t.id&&t.showDetail?s(t.tabName,{tag:"component",staticClass:"d-view",attrs:{"crm-type":t.crmType,id:t.id},on:{handle:t.detailHandle,"hide-view":t.hiddenView}}):t._e()],1)},[],!1,null,"196e9308",null);p.options.__file="CRMFullScreenDetail.vue";e.default=p.exports}}]);