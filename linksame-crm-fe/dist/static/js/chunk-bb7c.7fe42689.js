(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-bb7c"],{Qk79:function(t,e,a){"use strict";var i=a("mVjk");a.n(i).a},hbYI:function(t,e,a){"use strict";a.r(e);var i=a("QbLZ"),s=a.n(i),n=a("wd/R"),r=a.n(n),o=a("MT78"),l=a.n(o),c=a("MQ60"),p={name:"App",components:{draggable:a.n(c).a},props:{workId:[String,Number]},data:function(){return{activeName:"first",activeNames:"",status:!1,taskSprintData:[],dialogActive:!1,activeSprint:"",formStartActive:{sprintId:this.activeNames,name:"",startTime:"",endTime:""},notStartedList:[],processingList:[],completedList:[]}},watch:{},created:function(){},mounted:function(){this.retriveTaskSprintList(),this.retriveActiveList(),this.retriveActiving(),this.initAxisBurndown()},methods:{add:function(){this.list.push({name:"Juan"})},replace:function(){this.list=[{name:"Edgard"}]},clone:function(t){return{name:t.name+" cloned"}},log:function(t){window.console.log(t)},format:function(t){var e=r()(r()().format("YYYY-MM-DD HH:mm:ss")).diff(r()(this.activeSprint.endTime),"days"),a=r()(this.activeSprint.endTime).diff(r()(this.activeSprint.endTime),"days");return console.log("距离时间",e),console.log("总时间",a),0==a?"剩余 0 天":"剩余 "+e/a+" 天"},retriveActiving:function(){var t=this;this.$request.post("/taskSprint/queryCountAndTask").then(function(e){console.log("进行中的冲刺",e),t.notStarted=e.data.notStarted.notStartedList,t.processing=e.data.processing.processingList,t.completed=e.data.completed.completedList}).catch(function(t){console.log(t)})},retriveTaskSprintList:function(){var t=this,e=[];this.$request.post("/taskSprint/queryList?pageType=0").then(function(a){console.log("冲刺列表",a),a.data.forEach(function(a,i){e.push(a),t.$request.post("/task/queryList?pageType=0&sprintId="+a.sprintId).then(function(t){e[i].list=t.data,e[i].long=t.data.length}).catch(function(t){console.log(t)})})}).catch(function(t){console.log(t)}),console.log("处理数据",e),this.taskSprintData=e},handleClick:function(){this.retriveTaskSprintList(),this.retriveActiveList(),this.initAxis()},handleStartActive:function(t){var e=this;this.$request.post("/taskSprint/setSprint",{sprintId:t,status:1}).then(function(t){e.$message.success("开启冲刺成功"),e.retriveTaskSprintList()}).catch(function(t){console.log(t)})},handleDoneActive:function(t){var e=this;this.$request.post("/taskSprint/setSprint",{sprintId:t,status:2}).then(function(t){e.$message.success("完成冲刺成功"),e.retriveTaskSprintList()}).catch(function(t){console.log(t)})},handleDeleteActive:function(t){var e=this;console.log("删除id",t),this.$request.post("/taskSprint/delSprint",{sprintId:t}).then(function(t){e.$message.success("删除冲刺成功"),e.retriveTaskSprintList()}).catch(function(t){console.log(t)})},createStartActice:function(){var t=this;this.$request.post("/taskSprint/setSprint",s()({},this.formStartActive,{status:0})).then(function(e){console.log("新建冲刺",e),t.$message.success("新建冲刺成功"),t.dialogActive=!1,t.retriveTaskSprintList()}).catch(function(t){console.log(t)})},retriveTaskList:function(t,e){var a=this;this.$request.post("/task/queryList?pageType=0&sprintId="+t).then(function(t){console.log("冲刺列表任务",t),a.taskListData[e]=t.data}).catch(function(t){console.log(t)})},retriveActiveList:function(t,e){var a=this;this.$request.post("/taskSprint/queryList?pageType=0&status=1").then(function(t){console.log("活跃的冲刺",t),a.activeSprint=t.data[0]}).catch(function(t){console.log(t)})},initAxis:function(){var t=this;this.$request.post("/taskSprint/queryCountAndTask").then(function(e){console.log("任务个数",e);var a=l.a.init(document.getElementById("axismain")),i={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d})"},legend:{orient:"vertical",left:10,data:["待开始","进行中","已完成"]},series:[{name:"任务状态",type:"pie",radius:["50","70"],avoidLabelOverlap:!1,label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"24",fontWeight:"bold"}},labelLine:{show:!1},data:[{value:e.data.notStarted.notStartedCount,name:"待开始"},{value:e.data.processing.processingList,name:"进行中"},{value:e.data.completed.completedCount,name:"已完成"}]}]};a.setOption(i,!0),t.axisOption=i,t.axisChart=a}).catch(function(t){console.log(t)})},initAxisBurndown:function(){var t=this;this.$request.post("/taskSprint/querySprintInfo?sprintId=1").then(function(e){console.log("燃尽图",e);var a=l.a.init(document.getElementById("axismainBurndown")),i={title:{},grid:{top:"80px",left:"10px",bottom:"10px",containLabel:!0,borderColor:"red"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["期望值","剩余值"],icon:"circle",itemWidth:10,itemHeight:10,itemGap:40},series:[{name:"期望值",type:"line",yAxisIndex:0,color:"#0097F5",data:e.data.expectList},{name:"剩余值",type:"line",yAxisIndex:0,color:"#52C41A",data:e.data.remainingList}],xAxis:[{type:"category",name:"时间",data:e.data.dateList,axisTick:{alignWithLabel:!0,lineStyle:{width:0}},axisLabel:{color:"#BDBDBD"},axisLine:{lineStyle:{color:"#BDBDBD"}},splitLine:{show:!1}}],yAxis:[{type:"value",name:"任务数",data:[],axisTick:{alignWithLabel:!0,lineStyle:{width:0}},axisLabel:{color:"#BDBDBD",formatter:"{value} 个"},axisLine:{lineStyle:{color:"#BDBDBD"}},splitLine:{show:!1}}]};a.setOption(i,!0),t.axisOption=i,t.axisChart=a}).catch(function(t){console.log(t)})}}},d=(a("Qk79"),a("KHd+")),v=Object(d.a)(p,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{height:"100%"}},[a("div",{staticClass:"ls-header"},[a("el-row",{attrs:{gutter:100}},[a("el-col",{attrs:{span:20}},[t._v("活跃冲刺")]),t._v(" "),a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogActive=!0}}},[t._v("新建冲刺")])],1)],1)],1),t._v(" "),a("div",{staticClass:"ls-activebox"},[a("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"全部冲刺",name:"first"}},t._l(t.taskSprintData,function(e,i){return a("el-collapse",{key:i,model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[a("el-collapse-item",{attrs:{name:e.sprintId}},[a("template",{slot:"title"},[a("el-row",{staticStyle:{width:"100%"},attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:14}},[a("div",[a("span",{staticStyle:{"font-size":"18px"}},[t._v(t._s(e.name))])])]),t._v(" "),a("el-col",{attrs:{span:7}},[a("div",[a("el-tag",{attrs:{type:"info"}},[t._v(t._s(e.startTime)+" ~ "+t._s(e.endTime))])],1)]),t._v(" "),a("el-col",{attrs:{span:3}},[a("div",[1!=e.status?a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(a){t.handleStartActive(e.sprintId)}}},[t._v("开启冲刺")]):t._e(),t._v(" "),1==e.status?a("el-button",{attrs:{type:"success",plain:""},on:{click:function(a){t.handleDoneActive(e.sprintId)}}},[t._v("完成冲刺")]):t._e(),t._v(" "),a("el-button",{attrs:{type:"danger",plain:""},on:{click:function(a){t.handleDeleteActive(e.sprintId)}}},[t._v("删除冲刺")])],1)])],1)],1),t._v(" "),t._l(t.taskSprintData[i].list,function(e,i){return a("div",{key:i,staticStyle:{margin:"10px 0 0 0"}},[a("el-row",{attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:14}},[0==e.status?a("span",[a("el-tag",{attrs:{type:"warning"}},[t._v("未开始")])],1):t._e(),t._v(" "),1==e.status?a("span",[a("el-tag",{attrs:{type:"warning"}},[t._v("进行中")])],1):t._e(),t._v(" "),2==e.status?a("span",[a("el-tag",{attrs:{type:"warning"}},[t._v("完成冲刺")])],1):t._e(),t._v(" "),a("el-divider",{attrs:{direction:"vertical"}}),t._v(" "),a("span",[t._v(t._s(e.name))])],1),t._v(" "),a("el-col",{attrs:{span:7}},[a("el-tag",{attrs:{type:"info"}},[t._v(t._s(e.startTime)+" ~ "+t._s(e.stopTime))])],1),t._v(" "),a("el-col",{attrs:{span:3}},[a("el-avatar",{staticStyle:{background:"rgb(36,134,228)"},attrs:{size:30}},[a("span",{staticStyle:{"font-size":"10px"}},[t._v(t._s(e.mainRealname))])])],1)],1)],1)})],2)],1)})),t._v(" "),a("el-tab-pane",{attrs:{label:"进行中的冲刺",name:"second"}},[a("div",{staticClass:"crm-doing"},[a("el-row",{attrs:{type:"flex"}},[a("el-col",{staticClass:"crm-doing-col",attrs:{span:4}},[a("div",{staticClass:"crm-doing-header"},[t._v("未开始")]),t._v(" "),a("draggable",{staticClass:"list-group",attrs:{list:t.notStarted,group:"people"},on:{change:t.log}},t._l(t.notStarted,function(e,i){return a("div",{key:i,staticClass:"crm-list-group-item"},[t._v(t._s(e.name))])}))],1),t._v(" "),a("el-col",{staticClass:"crm-doing-col",attrs:{span:4}},[a("div",{staticClass:"crm-doing-header"},[t._v("进行中")]),t._v(" "),a("draggable",{staticClass:"list-group",attrs:{list:t.processing,group:"people"},on:{change:t.log}},t._l(t.processing,function(e,i){return a("div",{key:i,staticClass:"crm-list-group-item"},[t._v(t._s(e.name))])}))],1),t._v(" "),a("el-col",{staticClass:"crm-doing-col",attrs:{span:4}},[a("div",{staticClass:"crm-doing-header"},[t._v("已完成")]),t._v(" "),a("draggable",{staticClass:"list-group",attrs:{list:t.completed,group:"people"},on:{change:t.log}},t._l(t.completed,function(e,i){return a("div",{key:i,staticClass:"crm-list-group-item"},[t._v(t._s(e.name))])}))],1)],1)],1)]),t._v(" "),a("el-tab-pane",{attrs:{label:"冲刺统计",name:"third"}},[a("el-row",{attrs:{gutter:12}},[a("el-col",{attrs:{span:8}},[a("el-card",{staticStyle:{height:"300px"},attrs:{shadow:"hover"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[t._v(t._s(t.activeSprint.name))])]),t._v(" "),a("div",{staticStyle:{margin:"0 0 10px 0"}},[t._v("参与人")]),t._v(" "),t._l(t.activeSprint.mainUserList,function(e,i){return a("el-avatar",{key:i,staticStyle:{background:"rgb(36,134,228)"},attrs:{size:30}},[a("span",{staticStyle:{"font-size":"10px"}},[t._v(t._s(e.realname))])])}),t._v(" "),a("div",{staticStyle:{margin:"10px 0"}},[t._v("共 "+t._s(t.activeSprint.taskCount)+" 个任务")]),t._v(" "),a("div",{staticStyle:{margin:"10px 0","font-weight":"600"}},[t._v("冲刺目标: "+t._s(t.activeSprint.aimsName))]),t._v(" "),a("el-tag",{staticStyle:{margin:"10px 0"},attrs:{type:"info"}},[t._v(t._s(t.activeSprint.startTime)+" ~ "+t._s(t.activeSprint.endTime))])],2)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-card",{staticStyle:{height:"300px"},attrs:{shadow:"hover"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[t._v("状态分布")])]),t._v(" "),a("el-row",{attrs:{gutter:12}},[a("el-col",{attrs:{span:8}},[a("div",{staticStyle:{width:"500px",height:"200px"},attrs:{id:"axismain"}})])],1)],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-card",{staticStyle:{height:"300px"},attrs:{shadow:"hover"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[t._v("距离冲刺结束")])]),t._v(" "),a("div",{staticStyle:{margin:"40px 0 0 130px"}},[a("el-progress",{attrs:{percentage:25,format:t.format,type:"circle"}})],1)])],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-card",{staticStyle:{margin:"10px 0",width:"100%"},attrs:{shadow:"hover"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[t._v("任务燃尽图")])]),t._v(" "),a("div",{staticStyle:{width:"800px",height:"350px"},attrs:{id:"axismainBurndown"}})])],1)],1)],1)],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogActive,modal:!1,title:"开启冲刺",width:"50%"},on:{"update:visible":function(e){t.dialogActive=e}}},[a("el-form",[a("el-form-item",{attrs:{label:"冲刺目标"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入内容"},model:{value:t.formStartActive.name,callback:function(e){t.$set(t.formStartActive,"name",e)},expression:"formStartActive.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"开始时间"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间","default-time":"12:00:00","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.formStartActive.startTime,callback:function(e){t.$set(t.formStartActive,"startTime",e)},expression:"formStartActive.startTime"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"结束时间"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间","default-time":"12:00:00","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.formStartActive.endTime,callback:function(e){t.$set(t.formStartActive,"endTime",e)},expression:"formStartActive.endTime"}})],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogActive=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.createStartActice}},[t._v("确 定")])],1)],1)],1)])},[],!1,null,"1472f637",null);v.options.__file="index.vue";e.default=v.exports},mVjk:function(t,e,a){}}]);