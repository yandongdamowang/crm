(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4530"],{"+9th":function(t,e,a){"use strict";a.d(e,"k",function(){return n}),a.d(e,"a",function(){return o}),a.d(e,"d",function(){return r}),a.d(e,"e",function(){return c}),a.d(e,"g",function(){return i}),a.d(e,"h",function(){return l}),a.d(e,"b",function(){return u}),a.d(e,"f",function(){return d}),a.d(e,"c",function(){return f}),a.d(e,"j",function(){return h}),a.d(e,"i",function(){return p});var s=a("t3Un");function n(t){return Object(s.a)({url:"task/queryTaskList",method:"post",data:t})}function o(t){return Object(s.a)({url:"task/setTask",method:"post",data:t})}function r(t){return Object(s.a)({url:"task/deleteTask",method:"post",data:t})}function c(t){return Object(s.a)({url:"task/queryTaskInfo",method:"post",data:t})}function i(t){return Object(s.a)({url:"task/setTask",method:"post",data:t})}function l(t){return Object(s.a)({url:"task/saveTaskRelation",method:"post",data:t})}function u(t){return Object(s.a)({url:"taskLabel/setLabel",method:"post",data:t})}function d(t){return Object(s.a)({url:"taskLabel/setLabel",method:"post",data:t})}function f(t){return Object(s.a)({url:"taskLabel/deleteLabel",method:"post",data:t})}function h(t){return Object(s.a)({url:"taskLabel/getLabelList",method:"post",data:t})}function p(t){return Object(s.a)({url:"task/queryWorkTaskLog",method:"post",data:t})}},"1RnH":function(t,e,a){"use strict";a.r(e);var s=a("QbLZ"),n=a.n(s),o=a("+9th"),r=a("mkuN"),c=a("Er7M"),i=a("7Qib"),l=a("L2JU"),u={components:{CrmRelative:r.a,RelatedBusinessCell:c.a},props:{marginLeft:{type:String,default:"20px"},allData:{type:Object,default:function(){return{contacts:[],customer:[],business:[],contract:[]}}},isTask:{type:Boolean,default:!1},taskID:Number,alterable:{type:Boolean,default:!0},alterableColor:{type:String,default:"#999"}},data:function(){return{showTypes:["customer","contacts","business","contract"],showPopover:!1,relevanceAll:{customerIds:[],contractIds:[],contactsIds:[],businessIds:[]},relatedListData:{},showRelative:!1,showTaskRelative:!1}},computed:n()({},Object(l.b)(["crm"]),{showCRMPermission:function(){return this.crm}}),watch:{allData:function(){this.relatedListData=this.allData}},mounted:function(){this.relatedListData=this.allData},methods:{crmrelativeClose:function(){this.showPopover=!1},checkInfos:function(t){var e=this;this.showPopover=!1,this.relatedListData=t.data;var a=function(a){var s=t.data[a];e.relevanceAll[a+"Ids"]=s.map(function(t,e,s){return t[a+"Id"]})};for(var s in t.data)a(s);this.$emit("checkInfos",this.relevanceAll)},delRelevance:function(t,e,a){var s=this;this.$confirm("确认取消关联?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"is-particulars"}).then(function(){var a={taskId:s.taskID},n=Object(i.k)(s.relatedListData);n[t].splice(e,1);for(var r=function(t){var e=s.showTypes[t],o=n[e]||[];a[e+"Ids"]=o.map(function(t){return t[e+"Id"]}).join(",")},c=0;c<s.showTypes.length;c++)r(c);Object(o.h)(a).then(function(a){s.relatedListData[t].splice(e,1),s.relatedListData=Object(i.k)(s.relatedListData),s.$message.success("关联取消成功")}).catch(function(){})}).catch(function(){s.$message.info("已取消操作")})},checkRelatedDetail:function(t,e){e.key=e[t+"Id"],this.$emit("checkRelatedDetail",t,e)}}},d=(a("VPPU"),a("KHd+")),f=Object(d.a)(u,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"related-business",style:{"margin-left":t.marginLeft}},[!t.isTask&&t.alterable?s("el-popover",{attrs:{placement:"bottom",width:"800","popper-class":"no-padding-popover",trigger:"click"},model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}},[t.showRelative?s("crm-relative",{ref:"crmrelative",attrs:{show:t.showPopover,radio:!1,"selected-data":t.relatedListData,"show-types":t.showTypes},on:{close:t.crmrelativeClose,changeCheckout:t.checkInfos}}):t._e(),t._v(" "),t.showCRMPermission?s("p",{staticClass:"add-file",attrs:{slot:"reference"},on:{click:function(e){t.showRelative=!0}},slot:"reference"},[s("img",{attrs:{src:a("AFlK"),alt:""}}),t._v("\n      关联业务\n    ")]):t._e()],1):t._e(),t._v(" "),t.alterable?t._e():s("p",{staticClass:"alterable-p",style:{color:t.alterableColor}},[t._v("关联业务")]),t._v(" "),t._l(t.relatedListData,function(e,a){return s("div",{key:a},t._l(e,function(e,n){return s("related-business-cell",{key:n,attrs:{data:e,"cell-index":n,type:a,"show-foot":t.isTask},on:{unbind:t.delRelevance,detail:function(s){t.checkRelatedDetail(a,e)}}})}))}),t._v(" "),t.isTask?s("el-popover",{attrs:{placement:"bottom",width:"800","popper-class":"no-padding-popover",trigger:"click"},model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}},[t.showTaskRelative?s("crm-relative",{ref:"crmrelative",attrs:{radio:!1,show:t.showPopover,"selected-data":t.relatedListData,"show-types":t.showTypes},on:{close:t.crmrelativeClose,changeCheckout:t.checkInfos}}):t._e(),t._v(" "),t.showCRMPermission?s("p",{staticClass:"add-file",attrs:{slot:"reference"},on:{click:function(e){t.showTaskRelative=!0}},slot:"reference"},[s("img",{attrs:{src:a("AFlK"),alt:""}}),t._v("\n      关联业务\n    ")]):t._e()],1):t._e()],2)},[],!1,null,"e9d30324",null);f.options.__file="relatedBusiness.vue";e.default=f.exports},"4dUy":function(t,e,a){},VPPU:function(t,e,a){"use strict";var s=a("4dUy");a.n(s).a}}]);